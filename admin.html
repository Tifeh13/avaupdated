<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ava Admin ‚Äî Command Center</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,300;0,400;0,600;1,300&family=DM+Mono:wght@300;400;500&family=Montserrat:wght@200;300;400;500;600&display=swap" rel="stylesheet">
<style>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   DESIGN SYSTEM ‚Äî Obsidian & Gold Admin
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
:root {
  --gold: #D4AF37; --gold-dim: rgba(212,175,55,.18); --gold-glow: rgba(212,175,55,.3);
  --black: #060606; --surface: #0e0e0e; --panel: #131313; --raised: #191919; --border: rgba(212,175,55,.1); --border-bright: rgba(212,175,55,.35);
  --white: #F0EBE0; --muted: rgba(240,235,224,.5); --faint: rgba(240,235,224,.2);
  --green: #2ecc71; --red: #e74c3c; --blue: #3498db; --orange: #f39c12;
  --mono: 'DM Mono', monospace; --serif: 'Cormorant Garamond', serif; --sans: 'Montserrat', sans-serif;
  --sidebar: 220px; --topbar: 58px;
}
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
html, body { height: 100%; overflow: hidden; }
body { background: var(--black); color: var(--white); font-family: var(--sans); font-size: 13px; }
a { text-decoration: none; color: inherit; }
button, input, select, textarea { font-family: var(--sans); }
button { cursor: pointer; }
input, select, textarea { outline: none; }
img { display: block; }
::-webkit-scrollbar { width: 4px; height: 4px; }
::-webkit-scrollbar-track { background: transparent; }
::-webkit-scrollbar-thumb { background: var(--border-bright); border-radius: 2px; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOGIN SCREEN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.login-screen {
  position: fixed; inset: 0; background: var(--black);
  display: flex; align-items: center; justify-content: center; z-index: 9999;
  background-image: radial-gradient(ellipse at 30% 50%, rgba(212,175,55,.04) 0%, transparent 60%),
                    radial-gradient(ellipse at 70% 20%, rgba(212,175,55,.03) 0%, transparent 50%);
}
.login-box {
  width: 400px; padding: 3.5rem;
  border: 1px solid var(--border); background: var(--surface);
  position: relative; overflow: hidden;
}
.login-box::before {
  content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
  background: linear-gradient(90deg, transparent, var(--gold), transparent);
}
.login-logo { font-family: var(--serif); font-size: 2.2rem; font-weight: 300; letter-spacing: .4em; color: var(--gold); margin-bottom: .3rem; }
.login-sub { font-size: .58rem; letter-spacing: .4em; text-transform: uppercase; color: var(--muted); margin-bottom: 3rem; font-family: var(--mono); }
.login-label { font-size: .58rem; letter-spacing: .3em; text-transform: uppercase; color: var(--muted); display: block; margin-bottom: .6rem; }
.login-input {
  width: 100%; background: var(--panel); border: 1px solid var(--border); color: var(--white);
  padding: .9rem 1.2rem; font-family: var(--mono); font-size: .85rem; letter-spacing: .1em;
  transition: border-color .3s; margin-bottom: 1.5rem;
}
.login-input:focus { border-color: var(--gold); }
.login-btn {
  width: 100%; background: var(--gold); color: var(--black); border: none;
  padding: 1rem; font-size: .65rem; letter-spacing: .35em; text-transform: uppercase; font-weight: 600;
  transition: all .3s;
}
.login-btn:hover { background: #e5bf40; }
.login-err { color: var(--red); font-size: .6rem; letter-spacing: .1em; margin-top: .8rem; display: none; font-family: var(--mono); }
.login-err.show { display: block; }
.login-hint { font-size: .55rem; color: var(--faint); margin-top: 2rem; font-family: var(--mono); letter-spacing: .08em; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê APP SHELL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.app { display: none; height: 100vh; overflow: hidden; }
.app.visible { display: flex; }

/* SIDEBAR */
.sidebar {
  width: var(--sidebar); flex-shrink: 0; background: var(--surface);
  border-right: 1px solid var(--border); display: flex; flex-direction: column;
  height: 100vh; overflow: hidden;
}
.s-brand {
  padding: 1.5rem 1.4rem 1.2rem; border-bottom: 1px solid var(--border);
  flex-shrink: 0;
}
.s-logo { font-family: var(--serif); font-size: 1.5rem; font-weight: 300; letter-spacing: .35em; color: var(--gold); line-height: 1; }
.s-logo-sub { font-size: .45rem; letter-spacing: .5em; text-transform: uppercase; color: var(--faint); font-family: var(--mono); margin-top: .2rem; }
.s-badge { font-size: .48rem; letter-spacing: .2em; background: rgba(212,175,55,.12); color: var(--gold); border: 1px solid var(--gold-dim); padding: .2rem .6rem; display: inline-block; margin-top: .8rem; }
.s-nav { flex: 1; overflow-y: auto; padding: 1rem 0; }
.s-section { font-size: .48rem; letter-spacing: .4em; text-transform: uppercase; color: var(--faint); font-family: var(--mono); padding: .8rem 1.4rem .4rem; }
.s-item {
  display: flex; align-items: center; gap: .8rem; padding: .7rem 1.4rem;
  font-size: .65rem; letter-spacing: .08em; color: var(--muted); transition: all .25s;
  border-left: 2px solid transparent; cursor: pointer;
}
.s-item:hover { color: var(--white); background: rgba(255,255,255,.02); }
.s-item.active { color: var(--gold); border-left-color: var(--gold); background: var(--gold-dim); }
.s-item .ic { font-size: 1rem; width: 20px; text-align: center; flex-shrink: 0; }
.s-item .badge-ct {
  margin-left: auto; background: var(--gold); color: var(--black);
  font-size: .48rem; font-weight: 700; padding: .15rem .5rem; border-radius: 10px;
}
.s-foot {
  border-top: 1px solid var(--border); padding: 1rem 1.4rem;
  display: flex; align-items: center; gap: .8rem;
}
.s-avatar { width: 30px; height: 30px; background: var(--gold-dim); border: 1px solid var(--border-bright); border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: .7rem; color: var(--gold); flex-shrink: 0; }
.s-user { font-size: .6rem; color: var(--muted); }
.s-user strong { display: block; color: var(--white); font-size: .65rem; font-weight: 500; }
.s-logout { margin-left: auto; background: none; border: none; color: var(--faint); font-size: .75rem; transition: color .2s; }
.s-logout:hover { color: var(--red); }

/* MAIN AREA */
.main { flex: 1; display: flex; flex-direction: column; overflow: hidden; }
.topbar {
  height: var(--topbar); flex-shrink: 0; background: var(--surface);
  border-bottom: 1px solid var(--border); display: flex; align-items: center;
  padding: 0 2rem; gap: 1.5rem;
}
.topbar-title { font-family: var(--serif); font-size: 1.1rem; font-weight: 300; letter-spacing: .05em; }
.topbar-title span { color: var(--gold); font-style: italic; }
.topbar-r { margin-left: auto; display: flex; align-items: center; gap: 1rem; }
.topbar-time { font-family: var(--mono); font-size: .65rem; color: var(--muted); }
.topbar-link { font-size: .6rem; letter-spacing: .2em; text-transform: uppercase; color: var(--muted); border: 1px solid var(--border); padding: .35rem .9rem; transition: all .2s; }
.topbar-link:hover { border-color: var(--gold); color: var(--gold); }
.content { flex: 1; overflow-y: auto; padding: 2rem; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PANELS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.panel { display: none; }
.panel.active { display: block; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.stat-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 1rem; margin-bottom: 2rem; }
.stat-card {
  background: var(--panel); border: 1px solid var(--border); padding: 1.5rem;
  position: relative; overflow: hidden; transition: border-color .3s;
}
.stat-card:hover { border-color: var(--border-bright); }
.stat-card::after { content: ''; position: absolute; bottom: 0; left: 0; right: 0; height: 2px; }
.stat-card.gold::after { background: var(--gold); }
.stat-card.green::after { background: var(--green); }
.stat-card.blue::after { background: var(--blue); }
.stat-card.orange::after { background: var(--orange); }
.stat-label { font-size: .55rem; letter-spacing: .3em; text-transform: uppercase; color: var(--muted); font-family: var(--mono); margin-bottom: .7rem; }
.stat-val { font-family: var(--serif); font-size: 2rem; font-weight: 300; color: var(--white); line-height: 1; margin-bottom: .4rem; }
.stat-val span { font-size: 1rem; color: var(--gold); }
.stat-delta { font-size: .58rem; font-family: var(--mono); }
.stat-delta.up { color: var(--green); }
.stat-delta.dn { color: var(--red); }
.dash-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; }
.card { background: var(--panel); border: 1px solid var(--border); }
.card-head { padding: 1.2rem 1.5rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
.card-title { font-size: .58rem; letter-spacing: .35em; text-transform: uppercase; color: var(--gold); font-family: var(--mono); }
.card-body { padding: 1.5rem; }
.chart-area { height: 160px; position: relative; display: flex; align-items: flex-end; gap: 6px; }
.bar-wrap { flex: 1; display: flex; flex-direction: column; align-items: center; gap: .5rem; }
.bar { width: 100%; border-radius: 1px 1px 0 0; transition: height .6s cubic-bezier(.4,0,.2,1); position: relative; cursor: pointer; }
.bar:hover::after { content: attr(data-tip); position: absolute; top: -28px; left: 50%; transform: translateX(-50%); background: var(--raised); border: 1px solid var(--border-bright); font-size: .55rem; color: var(--white); padding: .2rem .5rem; white-space: nowrap; font-family: var(--mono); pointer-events: none; }
.bar-lbl { font-size: .48rem; font-family: var(--mono); color: var(--faint); letter-spacing: .08em; }
.cat-row { display: flex; align-items: center; gap: 1rem; padding: .65rem 0; border-bottom: 1px solid rgba(212,175,55,.05); }
.cat-row:last-child { border-bottom: none; }
.cat-name { font-size: .65rem; color: var(--muted); width: 80px; flex-shrink: 0; }
.cat-bar-wrap { flex: 1; height: 4px; background: rgba(255,255,255,.05); border-radius: 2px; overflow: hidden; }
.cat-bar { height: 100%; background: var(--gold); border-radius: 2px; transition: width .8s cubic-bezier(.4,0,.2,1); }
.cat-pct { font-family: var(--mono); font-size: .58rem; color: var(--gold); width: 35px; text-align: right; flex-shrink: 0; }
.recent-row { display: flex; align-items: center; gap: 1rem; padding: .7rem 0; border-bottom: 1px solid rgba(212,175,55,.05); }
.recent-row:last-child { border-bottom: none; }
.r-img { width: 38px; height: 38px; flex-shrink: 0; object-fit: cover; border: 1px solid var(--border); }
.r-name { flex: 1; font-size: .68rem; color: var(--white); }
.r-cat { font-size: .55rem; color: var(--muted); font-family: var(--mono); margin-top: .15rem; }
.r-price { font-family: var(--serif); font-size: 1rem; color: var(--gold); }
.activity-row { display: flex; align-items: center; gap: .8rem; padding: .55rem 0; }
.activity-dot { width: 6px; height: 6px; border-radius: 50%; flex-shrink: 0; }
.activity-txt { font-size: .63rem; color: var(--muted); flex: 1; }
.activity-txt strong { color: var(--white); }
.activity-time { font-family: var(--mono); font-size: .52rem; color: var(--faint); }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PRODUCTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.prod-toolbar { display: flex; align-items: center; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
.search-input {
  flex: 1; background: var(--panel); border: 1px solid var(--border); color: var(--white);
  padding: .6rem 1rem; font-size: .7rem; font-family: var(--mono); min-width: 200px;
  transition: border-color .3s;
}
.search-input:focus { border-color: var(--gold); }
.search-input::placeholder { color: var(--faint); }
.sel {
  background: var(--panel); border: 1px solid var(--border); color: var(--white);
  padding: .6rem .9rem; font-size: .65rem; font-family: var(--mono); cursor: pointer;
}
.sel:focus { border-color: var(--gold); }
.btn { padding: .6rem 1.4rem; font-size: .6rem; letter-spacing: .2em; text-transform: uppercase; font-weight: 600; border: none; transition: all .25s; cursor: pointer; display: inline-flex; align-items: center; gap: .5rem; }
.btn-gold { background: var(--gold); color: var(--black); }
.btn-gold:hover { background: #e5bf40; transform: translateY(-1px); }
.btn-outline { background: transparent; border: 1px solid var(--border); color: var(--muted); }
.btn-outline:hover { border-color: var(--gold); color: var(--gold); }
.btn-red { background: rgba(231,76,60,.15); border: 1px solid rgba(231,76,60,.3); color: var(--red); }
.btn-red:hover { background: rgba(231,76,60,.25); }
.btn-sm { padding: .4rem .9rem; font-size: .55rem; }
.prod-table { width: 100%; border-collapse: collapse; }
.prod-table th { font-size: .5rem; letter-spacing: .35em; text-transform: uppercase; color: var(--faint); font-family: var(--mono); font-weight: 400; padding: .6rem 1rem; text-align: left; border-bottom: 1px solid var(--border); background: var(--surface); }
.prod-table td { padding: .8rem 1rem; border-bottom: 1px solid rgba(212,175,55,.05); vertical-align: middle; }
.prod-table tr:hover td { background: rgba(212,175,55,.02); }
.td-img { width: 48px; height: 48px; object-fit: cover; border: 1px solid var(--border); flex-shrink: 0; }
.td-name { font-size: .72rem; color: var(--white); margin-bottom: .15rem; }
.td-mat { font-size: .58rem; color: var(--muted); font-family: var(--mono); }
.td-price { font-family: var(--serif); font-size: 1.05rem; color: var(--gold); }
.td-badge { display: inline-block; font-size: .48rem; font-weight: 700; letter-spacing: .15em; text-transform: uppercase; padding: .2rem .6rem; }
.b-new { background: var(--gold); color: var(--black); }
.b-sale { border: 1px solid var(--gold); color: var(--gold); }
.b-hot { background: var(--red); color: #fff; }
.b-limited { background: var(--raised); color: var(--muted); border: 1px solid var(--border); }
.td-acts { display: flex; gap: .5rem; align-items: center; }
.stars { color: var(--gold); font-size: .7rem; letter-spacing: 1px; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MODAL ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.overlay { position: fixed; inset: 0; background: rgba(0,0,0,.85); z-index: 1000; display: none; align-items: center; justify-content: center; backdrop-filter: blur(4px); }
.overlay.open { display: flex; }
.modal { background: var(--panel); border: 1px solid var(--border-bright); width: 680px; max-height: 90vh; overflow-y: auto; position: relative; }
.modal::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px; background: linear-gradient(90deg, transparent, var(--gold), transparent); }
.modal-head { padding: 1.5rem 2rem; border-bottom: 1px solid var(--border); display: flex; align-items: center; justify-content: space-between; }
.modal-title { font-family: var(--serif); font-size: 1.3rem; font-weight: 300; }
.modal-title em { color: var(--gold); font-style: italic; }
.modal-x { background: none; border: 1px solid var(--border); color: var(--muted); width: 32px; height: 32px; display: flex; align-items: center; justify-content: center; font-size: .9rem; transition: all .2s; }
.modal-x:hover { border-color: var(--gold); color: var(--gold); }
.modal-body { padding: 2rem; }
.form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.2rem; margin-bottom: 1.2rem; }
.form-full { grid-column: 1 / -1; }
.field { display: flex; flex-direction: column; gap: .5rem; }
.field label { font-size: .55rem; letter-spacing: .3em; text-transform: uppercase; color: var(--muted); font-family: var(--mono); }
.field input, .field select, .field textarea {
  background: var(--raised); border: 1px solid var(--border); color: var(--white);
  padding: .7rem 1rem; font-size: .72rem; font-family: var(--sans);
  transition: border-color .3s;
}
.field input:focus, .field select:focus, .field textarea:focus { border-color: var(--gold); }
.field select option { background: var(--raised); }
.field textarea { resize: vertical; min-height: 80px; }
.img-preview { width: 100%; height: 160px; object-fit: cover; border: 1px solid var(--border); margin-top: .5rem; display: none; }
.img-preview.show { display: block; }
.drop-zone {
  border: 1px dashed var(--border-bright); padding: 2rem; text-align: center;
  cursor: pointer; transition: all .3s; position: relative;
}
.drop-zone:hover, .drop-zone.drag { border-color: var(--gold); background: var(--gold-dim); }
.drop-zone input[type=file] { position: absolute; inset: 0; opacity: 0; cursor: pointer; }
.drop-icon { font-size: 2rem; margin-bottom: .5rem; opacity: .4; }
.drop-txt { font-size: .65rem; color: var(--muted); }
.drop-txt strong { color: var(--gold); }
.drop-sub { font-size: .55rem; color: var(--faint); font-family: var(--mono); margin-top: .3rem; }
.modal-foot { padding: 1.2rem 2rem; border-top: 1px solid var(--border); display: flex; justify-content: flex-end; gap: .8rem; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê IMAGE MANAGER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.img-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(160px, 1fr)); gap: 1rem; }
.img-card { background: var(--panel); border: 1px solid var(--border); overflow: hidden; position: relative; transition: border-color .3s; }
.img-card:hover { border-color: var(--border-bright); }
.img-card img { width: 100%; aspect-ratio: 1; object-fit: cover; display: block; }
.img-card-body { padding: .7rem; }
.img-card-name { font-size: .6rem; color: var(--muted); font-family: var(--mono); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: .4rem; }
.img-card-size { font-size: .52rem; color: var(--faint); font-family: var(--mono); }
.img-card-acts { display: flex; gap: .4rem; margin-top: .6rem; }
.img-use-btn { flex: 1; background: var(--gold); border: none; color: var(--black); padding: .4rem; font-size: .52rem; letter-spacing: .12em; text-transform: uppercase; font-weight: 600; transition: background .2s; }
.img-use-btn:hover { background: #e5bf40; }
.img-del-btn { background: none; border: 1px solid var(--border); color: var(--red); padding: .4rem .6rem; font-size: .7rem; transition: all .2s; }
.img-del-btn:hover { border-color: var(--red); background: rgba(231,76,60,.1); }
.img-badge { position: absolute; top: 8px; right: 8px; background: var(--green); color: #fff; font-size: .45rem; letter-spacing: .1em; text-transform: uppercase; font-weight: 700; padding: .2rem .5rem; }
.upload-big {
  border: 2px dashed var(--border-bright); padding: 3rem 2rem; text-align: center;
  cursor: pointer; transition: all .3s; margin-bottom: 1.5rem; position: relative;
}
.upload-big:hover, .upload-big.drag { border-color: var(--gold); background: var(--gold-dim); }
.upload-big input[type=file] { position: absolute; inset: 0; opacity: 0; cursor: pointer; width: 100%; height: 100%; }
.upload-icon { font-size: 3rem; opacity: .3; margin-bottom: 1rem; }
.upload-title { font-family: var(--serif); font-size: 1.4rem; font-weight: 300; margin-bottom: .5rem; }
.upload-sub { font-size: .65rem; color: var(--muted); }
.progress-bar { height: 3px; background: var(--raised); border-radius: 2px; overflow: hidden; margin-top: 1rem; display: none; }
.progress-bar.show { display: block; }
.progress-fill { height: 100%; background: var(--gold); border-radius: 2px; transition: width .3s; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ORDERS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.order-row { display: grid; grid-template-columns: 80px 1fr auto auto 120px; gap: 1rem; align-items: center; padding: 1rem 1.2rem; border-bottom: 1px solid rgba(212,175,55,.05); transition: background .2s; }
.order-row:hover { background: rgba(212,175,55,.02); }
.order-id { font-family: var(--mono); font-size: .6rem; color: var(--faint); }
.order-items { font-size: .68rem; color: var(--white); }
.order-items span { color: var(--muted); font-size: .6rem; display: block; margin-top: .15rem; font-family: var(--mono); }
.order-total { font-family: var(--serif); font-size: 1.1rem; color: var(--gold); }
.status { font-size: .52rem; letter-spacing: .15em; text-transform: uppercase; font-weight: 700; padding: .25rem .8rem; display: inline-block; }
.status-new { background: rgba(52,152,219,.15); border: 1px solid rgba(52,152,219,.35); color: var(--blue); }
.status-paid { background: rgba(46,204,113,.12); border: 1px solid rgba(46,204,113,.3); color: var(--green); }
.status-shipped { background: rgba(212,175,55,.12); border: 1px solid rgba(212,175,55,.3); color: var(--gold); }
.status-cancelled { background: rgba(231,76,60,.12); border: 1px solid rgba(231,76,60,.35); color: var(--red); }
.status-refunded { background: rgba(231,76,60,.08); border: 1px solid rgba(231,76,60,.25); color: var(--red); }
.order-act { display: flex; gap: .4rem; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ANALYTICS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.analytics-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 1.5rem; margin-bottom: 1.5rem; }
.big-chart { height: 220px; display: flex; align-items: flex-end; gap: 4px; padding: 0 .5rem; position: relative; }
.big-chart::before { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: repeating-linear-gradient(to bottom, transparent, transparent calc(100%/4 - 1px), rgba(212,175,55,.06) calc(100%/4)); pointer-events: none; }
.big-bar-wrap { flex: 1; display: flex; flex-direction: column; align-items: center; gap: .4rem; }
.big-bar { width: 100%; border-radius: 1px 1px 0 0; min-height: 2px; position: relative; cursor: pointer; transition: opacity .2s; }
.big-bar:hover { opacity: .8; }
.big-bar:hover::after { content: attr(data-tip); position: absolute; top: -32px; left: 50%; transform: translateX(-50%); background: var(--raised); border: 1px solid var(--border-bright); font-size: .55rem; color: var(--white); padding: .25rem .6rem; white-space: nowrap; font-family: var(--mono); z-index: 10; }
.big-lbl { font-size: .48rem; font-family: var(--mono); color: var(--faint); }
.donut-wrap { display: flex; align-items: center; gap: 2rem; }
.donut { position: relative; width: 140px; height: 140px; flex-shrink: 0; }
.donut svg { transform: rotate(-90deg); }
.donut-label { position: absolute; inset: 0; display: flex; flex-direction: column; align-items: center; justify-content: center; }
.donut-pct { font-family: var(--serif); font-size: 1.6rem; color: var(--gold); font-weight: 300; line-height: 1; }
.donut-sub { font-size: .5rem; letter-spacing: .2em; text-transform: uppercase; color: var(--faint); font-family: var(--mono); }
.donut-legend { display: flex; flex-direction: column; gap: .6rem; }
.legend-row { display: flex; align-items: center; gap: .6rem; }
.legend-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
.legend-name { font-size: .62rem; color: var(--muted); }
.legend-val { font-family: var(--mono); font-size: .58rem; color: var(--gold); margin-left: auto; padding-left: 1rem; }
.kpi-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1rem; }
.kpi { background: var(--panel); border: 1px solid var(--border); padding: 1.2rem 1.5rem; }
.kpi-label { font-size: .5rem; letter-spacing: .3em; text-transform: uppercase; color: var(--faint); font-family: var(--mono); margin-bottom: .6rem; }
.kpi-val { font-family: var(--serif); font-size: 1.6rem; font-weight: 300; color: var(--white); }
.kpi-val span { color: var(--gold); }
.kpi-trend { font-size: .58rem; font-family: var(--mono); margin-top: .3rem; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê TOAST ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.toast-box { position: fixed; bottom: 1.5rem; right: 1.5rem; z-index: 9000; display: flex; flex-direction: column; gap: .6rem; }
.toast { background: var(--raised); border: 1px solid var(--border); border-left: 3px solid var(--gold); padding: .8rem 1.2rem; font-size: .68rem; animation: tIn .35s ease; min-width: 240px; font-family: var(--mono); }
.toast.err { border-left-color: var(--red); }
.toast.out { animation: tOut .35s ease forwards; }
@keyframes tIn { from { transform: translateX(60px); opacity: 0; } to { transform: translateX(0); opacity: 1; } }
@keyframes tOut { to { transform: translateX(60px); opacity: 0; } }

/* EMPTY STATE */
.empty { text-align: center; padding: 5rem 2rem; }
.empty-icon { font-size: 3rem; opacity: .15; margin-bottom: 1rem; }
.empty-txt { font-family: var(--serif); font-size: 1.3rem; font-weight: 300; color: var(--muted); }
.empty-sub { font-size: .65rem; color: var(--faint); margin-top: .5rem; font-family: var(--mono); }

/* SECTION HEADER */
.sec-h { display: flex; align-items: flex-end; justify-content: space-between; margin-bottom: 1.5rem; }
.sec-title { font-family: var(--serif); font-size: 1.6rem; font-weight: 300; }
.sec-title em { color: var(--gold); font-style: italic; }
.sec-sub { font-size: .58rem; color: var(--faint); font-family: var(--mono); margin-top: .3rem; }

/* DIVIDER */
.divider { height: 1px; background: var(--border); margin: 1.5rem 0; }

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ADMIN.HTML ‚Äî FULL RESPONSIVE PASS
   ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
@media(max-width:1100px){
  :root{--sidebar:200px}
  .stat-grid{grid-template-columns:repeat(2,1fr)}
  .dash-grid{grid-template-columns:1fr}
  .analytics-grid{grid-template-columns:1fr}
  .kpi-grid{grid-template-columns:repeat(2,1fr)}
}
@media(max-width:900px){
  :root{--sidebar:0px}
  /* Sidebar slides in as drawer on mobile */
  .sidebar{
    position:fixed;top:0;left:-260px;width:260px;height:100vh;
    z-index:8000;transition:left .3s cubic-bezier(.4,0,.2,1);
    box-shadow:none;
  }
  .sidebar.mob-open{left:0;box-shadow:8px 0 40px rgba(0,0,0,.7)}
  .s-overlay{
    position:fixed;inset:0;background:rgba(0,0,0,.7);z-index:7999;
    display:none;
  }
  .s-overlay.open{display:block}
  .topbar{padding:0 1rem;gap:.8rem}
  .topbar-title{font-size:.9rem}
  .topbar-link{display:none}
  .mob-menu-btn{
    display:flex;align-items:center;justify-content:center;
    width:36px;height:36px;background:none;border:1px solid var(--border);
    color:var(--gold);font-size:1rem;flex-shrink:0;
  }
  .content{padding:1.2rem}
  .stat-grid{grid-template-columns:repeat(2,1fr);gap:.8rem}
  .stat-card{padding:1.2rem}
  .stat-val{font-size:1.6rem}
  .dash-grid{grid-template-columns:1fr;gap:1rem}
  .analytics-grid{grid-template-columns:1fr;gap:1rem}
  .kpi-grid{grid-template-columns:repeat(2,1fr);gap:.8rem}
  .order-row{grid-template-columns:60px 1fr auto;gap:.6rem}
  .order-row>div:nth-child(3){display:none}
  .prod-toolbar{flex-wrap:wrap}
  .search-input{min-width:100%;order:-1}
  .prod-table th:nth-child(7),.prod-table td:nth-child(7){display:none}
  .img-grid{grid-template-columns:repeat(auto-fill,minmax(140px,1fr))}
  .modal{width:95vw;max-width:95vw}
  .form-grid{grid-template-columns:1fr}
  .form-full{grid-column:1}
  .analytics-grid{grid-template-columns:1fr}
}
@media(max-width:600px){
  .stat-grid{grid-template-columns:1fr 1fr;gap:.6rem}
  .stat-val{font-size:1.4rem}
  .stat-label{font-size:.48rem}
  .stat-delta{font-size:.5rem}
  .kpi-grid{grid-template-columns:1fr 1fr}
  .kpi-val{font-size:1.3rem}
  .prod-table th:nth-child(6),.prod-table td:nth-child(6),
  .prod-table th:nth-child(5),.prod-table td:nth-child(5){display:none}
  .order-row{grid-template-columns:1fr auto;gap:.5rem}
  .order-row>div:first-child{display:none}
  .img-grid{grid-template-columns:repeat(auto-fill,minmax(120px,1fr));gap:.7rem}
  .content{padding:.8rem}
  .upload-big{padding:2rem 1rem}
  .upload-title{font-size:1.1rem}
  .modal-body{padding:1.2rem}
  .modal-head{padding:1rem 1.2rem}
  .modal-foot{padding:.8rem 1.2rem}
  .topbar{height:50px}
  .topbar-time{display:none}
}
/* Mobile menu button ‚Äî hidden on desktop */
.mob-menu-btn{display:none}


/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê PRODUCT MANAGER SPLIT LAYOUT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
.pm-split {
  display: grid;
  grid-template-columns: 1fr 360px;
  gap: 1.5rem;
  align-items: start;
}
.pm-list { min-width: 0; }
.pm-cards {
  display: flex;
  flex-direction: column;
  gap: .6rem;
  max-height: calc(100vh - 260px);
  overflow-y: auto;
  padding-right: .3rem;
}
.pm-card {
  display: flex;
  align-items: center;
  gap: .9rem;
  background: var(--panel);
  border: 1px solid var(--border);
  padding: .8rem 1rem;
  cursor: pointer;
  transition: all .2s;
}
.pm-card:hover { border-color: var(--border-bright); background: var(--raised); }
.pm-card.selected { border-color: var(--gold); background: var(--gold-dim); }
.pm-card-img { width: 52px; height: 52px; object-fit: cover; border: 1px solid var(--border); flex-shrink: 0; }
.pm-card-info { flex: 1; min-width: 0; }
.pm-card-name { font-size: .72rem; color: var(--white); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; margin-bottom: .2rem; }
.pm-card-sub { font-size: .55rem; color: var(--muted); font-family: var(--mono); }
.pm-card-price { font-family: var(--serif); font-size: 1rem; color: var(--gold); flex-shrink: 0; }
.pm-card-del { background: none; border: none; color: var(--faint); font-size: .8rem; padding: .2rem .4rem; transition: color .2s; flex-shrink: 0; }
.pm-card-del:hover { color: var(--red); }
.pm-form-wrap {
  background: var(--panel);
  border: 1px solid var(--border);
  position: sticky;
  top: calc(var(--topbar) + 1rem);
  max-height: calc(100vh - 100px);
  overflow-y: auto;
}
.pm-form-head {
  padding: 1rem 1.2rem;
  border-bottom: 1px solid var(--border);
  display: flex;
  align-items: center;
  justify-content: space-between;
  background: var(--surface);
  position: sticky;
  top: 0;
  z-index: 2;
}
.pm-form-title {
  font-size: .65rem;
  letter-spacing: .2em;
  text-transform: uppercase;
  color: var(--gold);
  font-family: var(--mono);
}
.pm-form-reset {
  font-size: .55rem;
  letter-spacing: .15em;
  text-transform: uppercase;
  background: none;
  border: 1px solid var(--border);
  color: var(--muted);
  padding: .3rem .7rem;
  transition: all .2s;
}
.pm-form-reset:hover { border-color: var(--gold); color: var(--gold); }
.pm-form-body { padding: 1.2rem; }
.pm-add-new {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: .5rem;
  border: 1px dashed var(--border-bright);
  color: var(--gold);
  font-size: .6rem;
  letter-spacing: .25em;
  text-transform: uppercase;
  padding: .8rem;
  cursor: pointer;
  transition: all .2s;
  background: transparent;
  width: 100%;
  margin-bottom: .8rem;
  font-family: var(--sans);
}
.pm-add-new:hover { background: var(--gold-dim); border-style: solid; }

/* Responsive split */
@media(max-width:1100px) {
  .pm-split { grid-template-columns: 1fr 320px; }
}
@media(max-width:900px) {
  .pm-split { grid-template-columns: 1fr; }
  .pm-form-wrap { position: static; max-height: none; }
  .pm-cards { max-height: 400px; }
}

</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê LOGIN ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="login-screen" id="loginScreen">
  <div class="login-box">
    <div class="login-logo">AVA</div>
    <div class="login-sub">Admin Console ¬∑ Restricted Access</div>
    <label class="login-label" for="pwInput">Password</label>
    <input class="login-input" type="password" id="pwInput" placeholder="Enter admin password" onkeydown="if(event.key==='Enter')doLogin()">
    <button class="login-btn" onclick="doLogin()">Access Admin Panel ‚Üí</button>
    <div class="login-err" id="loginErr">‚ö† Incorrect password. Please try again.</div>
    <div class="login-hint">Default password: <strong>ava2026</strong> ‚Äî change this in settings</div>
  </div>
</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê APP ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<div class="app" id="app">

  <!-- SIDEBAR -->
  <div class="s-overlay" id="sOverlay" onclick="closeSidebar()"></div>
  <aside class="sidebar" id="adminSidebar">
    <div class="s-brand">
      <div class="s-logo">AVA<div class="s-logo-sub">Jewelry</div></div>
      <div class="s-badge">Admin Panel</div>
    </div>
    <nav class="s-nav">
      <div class="s-section">Overview</div>
      <div class="s-item active" onclick="gotoPanel('dashboard',this)">
        <span class="ic">üìä</span> Dashboard
      </div>
      <div class="s-section">Catalog</div>
      <div class="s-item" onclick="gotoPanel('products',this)">
        <span class="ic">üíé</span> Products
        <span class="badge-ct" id="prodBadge">0</span>
      </div>
      <div class="s-item" onclick="gotoPanel('images',this)">
        <span class="ic">üñºÔ∏è</span> Image Library
        <span class="badge-ct" id="imgBadge">0</span>
      </div>
      <div class="s-section">Commerce</div>
      <div class="s-item" onclick="gotoPanel('orders',this)">
        <span class="ic">üì¶</span> Orders
        <span class="badge-ct" id="orderBadge">0</span>
      </div>
      <div class="s-item" onclick="gotoPanel('customers',this)">
        <span class="ic">üë•</span> Customers
        <span class="badge-ct" id="custBadge">0</span>
      </div>
      <div class="s-item" onclick="gotoPanel('analytics',this)">
        <span class="ic">üìà</span> Analytics
      </div>
    </nav>
    <div class="s-foot">
      <div class="s-avatar">A</div>
      <div class="s-user"><strong>Admin</strong>ava-jewelry.com</div>
      <button class="s-logout" onclick="doLogout()" title="Sign out">‚èè</button>
    </div>
  </aside>

  <!-- MAIN -->
  <main class="main">
    <div class="topbar">
      <button class="mob-menu-btn" id="mobMenuBtn" onclick="toggleSidebar()">‚ò∞</button>
      <div class="topbar-title" id="topbarTitle">Dashboard <span>Overview</span></div>
      <div class="topbar-r">
        <div class="topbar-time" id="clock"></div>
        <a href="index.html" target="_blank" class="topbar-link">View Site ‚Üó</a>
        <a href="shop.html" target="_blank" class="topbar-link">Shop ‚Üó</a>
      </div>
    </div>
    <div class="content" id="content">

      <!-- ‚ïê‚ïê DASHBOARD ‚ïê‚ïê -->
      <div class="panel active" id="panel-dashboard">
        <div class="stat-grid" id="statGrid"></div>
        <div class="dash-grid">
          <div class="card">
            <div class="card-head"><div class="card-title">Revenue ‚Äî Last 8 Weeks</div></div>
            <div class="card-body">
              <div class="chart-area" id="revenueChart"></div>
            </div>
          </div>
          <div class="card">
            <div class="card-head"><div class="card-title">Sales by Category</div></div>
            <div class="card-body" id="catChart"></div>
          </div>
          <div class="card">
            <div class="card-head"><div class="card-title">Top Products</div></div>
            <div class="card-body" id="topProds"></div>
          </div>
          <div class="card">
            <div class="card-head"><div class="card-title">Recent Activity</div></div>
            <div class="card-body" id="actFeed"></div>
          </div>
        </div>
      </div>

      <!-- ‚ïê‚ïê PRODUCTS ‚ïê‚ïê -->
      <div class="panel" id="panel-products">
        <!-- Top bar -->
        <div class="sec-h" style="margin-bottom:1rem">
          <div>
            <div class="sec-title">Product <em>Manager</em></div>
            <div class="sec-sub" id="prodSubtitle">Loading catalog...</div>
          </div>
          <button class="btn btn-outline btn-sm" onclick="exportCSV()">‚¨á Export CSV</button>
        </div>

        <!-- Split layout: list left, form right -->
        <div class="pm-split">

          <!-- LEFT: product list -->
          <div class="pm-list">
            <div class="prod-toolbar">
              <input class="search-input" type="text" placeholder="üîç Search products..." id="prodSearch" oninput="filterProds()" style="flex:1;min-width:0">
              <select class="sel" id="catFilter" onchange="filterProds()">
                <option value="">All Categories</option>
                <option>Rings</option><option>Watches</option><option>Necklaces</option>
                <option>Bracelets</option><option>Earrings</option>
              </select>
              <select class="sel" id="badgeFilter" onchange="filterProds()">
                <option value="">All Badges</option>
                <option>new</option><option>sale</option><option>hot</option><option>limited</option>
              </select>
            </div>
            <div class="pm-cards" id="prodCards"></div>
          </div>

          <!-- RIGHT: add/edit form -->
          <div class="pm-form-wrap">
            <div class="pm-form-head">
              <div class="pm-form-title" id="pmFormTitle">‚ú¶ Add New Product</div>
              <button class="pm-form-reset" id="pmResetBtn" onclick="resetProductForm()" style="display:none">‚Üê Back to New</button>
            </div>
            <div class="pm-form-body">
              <div class="field" style="margin-bottom:1rem">
                <label>Product Name *</label>
                <input type="text" id="f-name" placeholder="e.g. Lumi√®re Solitaire Ring">
              </div>
              <div style="display:grid;grid-template-columns:1fr 1fr;gap:.8rem;margin-bottom:.8rem">
                <div class="field">
                  <label>Category</label>
                  <select id="f-cat">
                    <option>Rings</option><option>Watches</option><option>Necklaces</option>
                    <option>Bracelets</option><option>Earrings</option>
                  </select>
                </div>
                <div class="field">
                  <label>Badge</label>
                  <select id="f-badge">
                    <option value="">None</option>
                    <option value="new">New</option><option value="sale">Sale</option>
                    <option value="hot">Hot</option><option value="limited">Limited</option>
                  </select>
                </div>
                <div class="field">
                  <label>Price *</label>
                  <input type="text" id="f-price" placeholder="$4,299">
                </div>
                <div class="field">
                  <label>Original Price</label>
                  <input type="text" id="f-old" placeholder="$5,374">
                </div>
                <div class="field">
                  <label>Metal</label>
                  <select id="f-metal">
                    <option value="yellow gold">18K Yellow Gold</option>
                    <option value="white gold">18K White Gold</option>
                    <option value="rose gold">18K Rose Gold</option>
                    <option value="platinum">Platinum</option>
                  </select>
                </div>
                <div class="field">
                  <label>Stone</label>
                  <select id="f-stone">
                    <option value="diamond">Diamond</option>
                    <option value="sapphire">Sapphire</option>
                    <option value="ruby">Ruby</option>
                    <option value="emerald">Emerald</option>
                    <option value="none">None</option>
                  </select>
                </div>
                <div class="field">
                  <label>Stock (blank = unlimited)</label>
                  <input type="number" id="f-stock" placeholder="e.g. 3">
                </div>
                <div class="field">
                  <label>Rating (1‚Äì5)</label>
                  <input type="number" id="f-rating" min="1" max="5" value="5">
                </div>
              </div>
              <div class="field" style="margin-bottom:.8rem">
                <label>Material Description</label>
                <input type="text" id="f-mat" placeholder="18K White Gold ¬∑ 1.2ct VVS1 Round Brilliant">
              </div>
              <div class="field" style="margin-bottom:.8rem">
                <label>Image URL</label>
                <input type="text" id="f-img" placeholder="https://images.pexels.com/... or paste base64" oninput="previewImg()">
                <img id="imgPreview" class="img-preview" alt="Preview">
              </div>
              <div class="field" style="margin-bottom:1.2rem">
                <label>Or Upload Photo Directly</label>
                <div class="drop-zone" id="inlineDropZone">
                  <input type="file" accept="image/*" onchange="inlineUpload(this)">
                  <div class="drop-icon">üì∑</div>
                  <div class="drop-txt">Click or drag ¬∑ <strong>embeds as base64</strong></div>
                </div>
              </div>
              <button class="btn btn-gold" style="width:100%;padding:.9rem;font-size:.65rem" onclick="saveProduct()" id="pmSaveBtn">‚ú¶ Save Product</button>
              <button class="btn btn-red btn-sm" style="width:100%;margin-top:.6rem;display:none" id="pmDeleteBtn" onclick="deleteCurrentProduct()">Delete This Product</button>
            </div>
          </div>

        </div>
      </div>

      <!-- ‚ïê‚ïê IMAGES ‚ïê‚ïê -->
      <div class="panel" id="panel-images">
        <div class="sec-h">
          <div>
            <div class="sec-title">Image <em>Library</em></div>
            <div class="sec-sub">Upload your own photos ‚Äî they embed directly into the site</div>
          </div>
          <button class="btn btn-outline btn-sm" onclick="clearAllImages()">Clear Library</button>
        </div>

        <div class="upload-big" id="uploadZone">
          <input type="file" accept="image/*" multiple onchange="handleFiles(this.files)" id="fileInput">
          <div class="upload-icon">üì∏</div>
          <div class="upload-title">Drop your jewelry photos here</div>
          <div class="upload-sub">JPG, PNG, WEBP ¬∑ Any size ¬∑ Multiple files at once<br>Images are converted to base64 and stored in your browser</div>
          <div class="progress-bar" id="progressBar"><div class="progress-fill" id="progressFill" style="width:0%"></div></div>
        </div>

        <div class="card" style="margin-bottom:1.5rem">
          <div class="card-head">
            <div class="card-title">How to use your images</div>
          </div>
          <div class="card-body" style="font-size:.65rem;color:var(--muted);line-height:1.8;font-family:var(--mono)">
            1. Upload a photo above ‚Äî it stores in your browser instantly<br>
            2. Click <strong style="color:var(--gold)">Use as Product Image</strong> on any photo<br>
            3. Go to <strong style="color:var(--white)">Products</strong> ‚Üí Edit a product ‚Üí the image URL is pre-filled<br>
            4. Save the product ‚Äî your photo now shows on the shop
          </div>
        </div>

        <div class="img-grid" id="imgGrid">
          <div class="empty"><div class="empty-icon">üì∑</div><div class="empty-txt">No images yet</div><div class="empty-sub">Upload your first jewelry photo above</div></div>
        </div>
      </div>

      <!-- ‚ïê‚ïê ORDERS ‚ïê‚ïê -->
      <div class="panel" id="panel-orders">
        <div class="sec-h">
          <div>
            <div class="sec-title">Orders <em>Dashboard</em></div>
            <div class="sec-sub" id="orderSub">Showing all customer orders</div>
          </div>
          <div style="display:flex;gap:.5rem">
            <button class="btn btn-outline btn-sm" onclick="exportOrders()">Export CSV</button>
            <button class="btn btn-outline btn-sm" onclick="clearOrders()">Clear Live</button>
          </div>
        </div>

        <!-- Stats row -->
        <div style="display:grid;grid-template-columns:repeat(4,1fr);gap:1rem;margin-bottom:1.5rem">
          <div class="card" style="padding:1.2rem">
            <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Total Orders</div>
            <div style="font-family:var(--serif);font-size:1.8rem;color:var(--gold)" id="stat-orders">0</div>
          </div>
          <div class="card" style="padding:1.2rem">
            <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Total Revenue</div>
            <div style="font-family:var(--serif);font-size:1.8rem;color:var(--gold)" id="stat-revenue">$0</div>
          </div>
          <div class="card" style="padding:1.2rem">
            <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Avg Order Value</div>
            <div style="font-family:var(--serif);font-size:1.8rem;color:var(--gold)" id="stat-avg">$0</div>
          </div>
          <div class="card" style="padding:1.2rem">
            <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Crypto Orders</div>
            <div style="font-family:var(--serif);font-size:1.8rem;color:var(--gold)" id="stat-crypto">0</div>
          </div>
        </div>

        <div class="card">
          <div class="card-head" style="display:flex;justify-content:space-between;align-items:center">
            <div class="card-title">All Orders</div>
            <input type="text" id="orderSearch" placeholder="Search orders..." onkeyup="filterOrders()"
              style="background:var(--surface);border:1px solid var(--border);color:var(--white);padding:.4rem .8rem;font-size:.65rem;width:200px">
          </div>
          <div id="ordersBody" style="overflow-x:auto"></div>
        </div>

        <!-- Order detail modal -->
        <div id="orderModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:9999;align-items:center;justify-content:center">
          <div style="background:var(--surface);border:1px solid var(--border);width:min(700px,95vw);max-height:90vh;overflow-y:auto;padding:2rem;position:relative">
            <button onclick="closeOrderModal()" style="position:absolute;top:1rem;right:1rem;background:none;border:1px solid var(--border);color:var(--faint);width:30px;height:30px;font-size:.9rem">‚úï</button>
            <div id="orderModalBody"></div>
          </div>
        </div>
      </div>

      <!-- CUSTOMERS PANEL -->
      <div class="panel" id="panel-customers">
        <div class="sec-h">
          <div>
            <div class="sec-title">Customer <em>Details</em></div>
            <div class="sec-sub">Full customer profiles including payment & shipping info</div>
          </div>
          <input type="text" id="custSearch" placeholder="Search customers..." onkeyup="filterCustomers()"
            style="background:var(--surface);border:1px solid var(--border);color:var(--white);padding:.4rem .8rem;font-size:.65rem;width:220px">
        </div>
        <div class="card">
          <div class="card-head">
            <div class="card-title">All Customers</div>
          </div>
          <div id="customersBody" style="overflow-x:auto"></div>
        </div>

        <!-- Customer detail modal -->
        <div id="custModal" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,.85);z-index:9999;align-items:center;justify-content:center">
          <div style="background:var(--surface);border:1px solid var(--border);width:min(700px,95vw);max-height:90vh;overflow-y:auto;padding:2rem;position:relative">
            <button onclick="closeCustModal()" style="position:absolute;top:1rem;right:1rem;background:none;border:1px solid var(--border);color:var(--faint);width:30px;height:30px;font-size:.9rem">‚úï</button>
            <div id="custModalBody"></div>
          </div>
        </div>
      </div>

      <!-- ‚ïê‚ïê ANALYTICS ‚ïê‚ïê -->
      <div class="panel" id="panel-analytics">
        <div class="sec-h">
          <div>
            <div class="sec-title">Sales <em>Analytics</em></div>
            <div class="sec-sub">Catalog insights & simulated performance data</div>
          </div>
        </div>

        <div class="stat-grid" id="analyticsStats"></div>

        <div class="analytics-grid">
          <div class="card">
            <div class="card-head"><div class="card-title">Monthly Revenue Trend</div></div>
            <div class="card-body">
              <div class="big-chart" id="bigChart"></div>
            </div>
          </div>
          <div class="card">
            <div class="card-head"><div class="card-title">Category Revenue Share</div></div>
            <div class="card-body">
              <div class="donut-wrap" id="donutWrap"></div>
            </div>
          </div>
        </div>

        <div class="card" style="margin-bottom:1.5rem">
          <div class="card-head"><div class="card-title">Key Performance Indicators</div></div>
          <div class="card-body"><div class="kpi-grid" id="kpiGrid"></div></div>
        </div>

        <div class="card">
          <div class="card-head"><div class="card-title">Price Distribution by Category</div></div>
          <div class="card-body" id="priceDistChart"></div>
        </div>
      </div>

    </div>
  </main>
</div>

<!-- PRODUCT MODAL -->
<div class="overlay" id="prodModal">
  <div class="modal">
    <div class="modal-head">
      <div class="modal-title" id="modalTitle">Add <em>Product</em></div>
      <button class="modal-x" onclick="closeModal()">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="form-grid">
        <div class="field form-full">
          <label>Product Name</label>
          <input type="text" id="f-name" placeholder="e.g. Lumi√®re Solitaire Ring">
        </div>
        <div class="field">
          <label>Category</label>
          <select id="f-cat">
            <option>Rings</option><option>Watches</option><option>Necklaces</option>
            <option>Bracelets</option><option>Earrings</option>
          </select>
        </div>
        <div class="field">
          <label>Badge</label>
          <select id="f-badge">
            <option value="">None</option>
            <option value="new">New</option><option value="sale">Sale</option>
            <option value="hot">Hot</option><option value="limited">Limited</option>
          </select>
        </div>
        <div class="field">
          <label>Price (e.g. $4,299)</label>
          <input type="text" id="f-price" placeholder="$0,000">
        </div>
        <div class="field">
          <label>Original Price (optional)</label>
          <input type="text" id="f-old" placeholder="$0,000">
        </div>
        <div class="field">
          <label>Metal</label>
          <select id="f-metal">
            <option value="yellow gold">18K Yellow Gold</option>
            <option value="white gold">18K White Gold</option>
            <option value="rose gold">18K Rose Gold</option>
            <option value="platinum">Platinum</option>
          </select>
        </div>
        <div class="field">
          <label>Stone</label>
          <select id="f-stone">
            <option value="diamond">Diamond</option>
            <option value="sapphire">Sapphire</option>
            <option value="ruby">Ruby</option>
            <option value="emerald">Emerald</option>
            <option value="none">None</option>
          </select>
        </div>
        <div class="field form-full">
          <label>Material Description</label>
          <input type="text" id="f-mat" placeholder="e.g. 18K White Gold ¬∑ 1.2ct VVS1 Round Brilliant">
        </div>
        <div class="field">
          <label>Stock (leave empty = unlimited)</label>
          <input type="number" id="f-stock" placeholder="e.g. 3">
        </div>
        <div class="field">
          <label>Rating (1‚Äì5)</label>
          <input type="number" id="f-rating" min="1" max="5" value="5">
        </div>
        <div class="field">
          <label>Review Count</label>
          <input type="number" id="f-rev" placeholder="e.g. 42" value="0">
        </div>
        <div class="field form-full">
          <label>Image URL ‚Äî or upload from Image Library</label>
          <input type="text" id="f-img" placeholder="https://... or paste base64 data URI" oninput="previewImg()">
          <img id="imgPreview" class="img-preview" alt="Preview">
        </div>
        <div class="field form-full">
          <label>Upload Image Directly</label>
          <div class="drop-zone" id="inlineDropZone">
            <input type="file" accept="image/*" onchange="inlineUpload(this)">
            <div class="drop-icon">üì∑</div>
            <div class="drop-txt">Click or drag to upload ¬∑ <strong>converts to base64</strong></div>
            <div class="drop-sub">Embeds directly ‚Äî no external hosting needed</div>
          </div>
        </div>
      </div>
    </div>
    <div class="modal-foot">
      <button class="btn btn-outline" onclick="closeModal()">Cancel</button>
      <button class="btn btn-gold" onclick="saveProduct()">Save Product ‚Üí</button>
    </div>
  </div>
</div>

<div class="toast-box" id="toastBox"></div>

<script>
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// BASE CATALOG ‚Äî seeded from your shop
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const BASE_CATALOG = [
  {id:1,cat:"Rings",name:"Lumi√®re Solitaire Ring",mat:"18K White Gold ¬∑ 1.2ct VVS1 Round Brilliant",price:"$4,299",num:4299,old:"$5,374",badge:"sale",rating:5,rev:87,stock:null,metal:"white gold",stone:"diamond",img:"https://images.pexels.com/photos/190819/pexels-photo-190819.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:2,cat:"Rings",name:"Auric Trilogy Ring",mat:"18K Yellow Gold ¬∑ 2ct Three-Stone Diamond",price:"$7,800",num:7800,old:null,badge:"hot",rating:5,rev:41,stock:4,metal:"yellow gold",stone:"diamond",img:"https://images.pexels.com/photos/1458867/pexels-photo-1458867.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:3,cat:"Rings",name:"C√©leste Pav√© Band",mat:"18K Yellow Gold ¬∑ Full Pav√© Diamond Set",price:"$3,400",num:3400,old:"$4,000",badge:"sale",rating:4,rev:35,stock:null,metal:"yellow gold",stone:"diamond",img:"https://images.pexels.com/photos/265906/pexels-photo-265906.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:4,cat:"Rings",name:"Ros√© Oval Solitaire",mat:"18K Rose Gold ¬∑ 1ct Oval Diamond",price:"$5,200",num:5200,old:null,badge:"new",rating:5,rev:22,stock:3,metal:"rose gold",stone:"diamond",img:"https://images.pexels.com/photos/1682637/pexels-photo-1682637.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:5,cat:"Rings",name:"Ceylon Sapphire Ring",mat:"18K Platinum ¬∑ 3ct Ceylon Sapphire",price:"$6,800",num:6800,old:"$8,200",badge:"sale",rating:4,rev:31,stock:null,metal:"platinum",stone:"sapphire",img:"https://images.pexels.com/photos/691046/pexels-photo-691046.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:6,cat:"Rings",name:"Marquise Ruby Statement",mat:"18K Yellow Gold ¬∑ Burmese Ruby Centre",price:"$8,400",num:8400,old:null,badge:"limited",rating:5,rev:14,stock:2,metal:"yellow gold",stone:"ruby",img:"https://images.pexels.com/photos/3266400/pexels-photo-3266400.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:7,cat:"Watches",name:"Auric Chronograph II",mat:"18K Yellow Gold ¬∑ Automatic Movement",price:"$12,500",num:12500,old:null,badge:"new",rating:5,rev:28,stock:3,metal:"yellow gold",stone:"none",img:"https://images.pexels.com/photos/125779/pexels-photo-125779.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:8,cat:"Watches",name:"Pav√© Lady Timepiece",mat:"18K Rose Gold ¬∑ Diamond Bezel ¬∑ 36mm",price:"$18,000",num:18000,old:null,badge:"limited",rating:5,rev:11,stock:2,metal:"rose gold",stone:"diamond",img:"https://images.pexels.com/photos/277390/pexels-photo-277390.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:9,cat:"Watches",name:"Prestige Dress Watch",mat:"18K White Gold ¬∑ Swiss Automatic ¬∑ 40mm",price:"$9,200",num:9200,old:null,badge:null,rating:4,rev:18,stock:null,metal:"white gold",stone:"none",img:"https://images.pexels.com/photos/9978753/pexels-photo-9978753.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:10,cat:"Watches",name:"Grand Chronos Tourbillon",mat:"18K Rose Gold ¬∑ Manual Wind ¬∑ 42mm",price:"$24,000",num:24000,old:null,badge:"limited",rating:5,rev:6,stock:1,metal:"rose gold",stone:"none",img:"https://images.pexels.com/photos/2783873/pexels-photo-2783873.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:11,cat:"Necklaces",name:"Celeste Diamond Necklace",mat:"18K Yellow Gold ¬∑ 3.5ct Tennis Style",price:"$8,900",num:8900,old:null,badge:null,rating:5,rev:44,stock:null,metal:"yellow gold",stone:"diamond",img:"https://images.pexels.com/photos/1191531/pexels-photo-1191531.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:12,cat:"Necklaces",name:"Aurora Diamond Pendant",mat:"18K White Gold ¬∑ Floating Diamond Drop",price:"$2,800",num:2800,old:null,badge:"new",rating:5,rev:52,stock:null,metal:"white gold",stone:"diamond",img:"https://images.pexels.com/photos/1616096/pexels-photo-1616096.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:13,cat:"Necklaces",name:"Infinity Diamond Collar",mat:"18K White Gold ¬∑ 5ct Total Weight",price:"$14,200",num:14200,old:null,badge:"limited",rating:5,rev:9,stock:2,metal:"white gold",stone:"diamond",img:"https://images.pexels.com/photos/3014853/pexels-photo-3014853.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:14,cat:"Necklaces",name:"Riviera Sapphire Pendant",mat:"18K Rose Gold ¬∑ Ceylon Sapphire Drop",price:"$3,600",num:3600,old:null,badge:null,rating:5,rev:27,stock:null,metal:"rose gold",stone:"sapphire",img:"https://images.pexels.com/photos/1413420/pexels-photo-1413420.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:15,cat:"Necklaces",name:"Verdure Emerald Drop",mat:"18K Yellow Gold ¬∑ Colombian Emerald",price:"$5,100",num:5100,old:"$6,300",badge:"sale",rating:4,rev:19,stock:null,metal:"yellow gold",stone:"emerald",img:"https://images.pexels.com/photos/2735970/pexels-photo-2735970.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:16,cat:"Bracelets",name:"Rivi√®re Tennis Bracelet",mat:"18K Rose Gold ¬∑ 2ct Total Diamond",price:"$6,200",num:6200,old:null,badge:"hot",rating:4,rev:63,stock:5,metal:"rose gold",stone:"diamond",img:"https://images.pexels.com/photos/1462726/pexels-photo-1462726.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:17,cat:"Bracelets",name:"Heritage Charm Bracelet",mat:"18K Yellow Gold ¬∑ 12 Hand-Set Charms",price:"$1,850",num:1850,old:null,badge:"new",rating:5,rev:33,stock:null,metal:"yellow gold",stone:"none",img:"https://images.pexels.com/photos/3687609/pexels-photo-3687609.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:18,cat:"Bracelets",name:"Manchette Cuff",mat:"18K White Gold ¬∑ Hammered & Polished",price:"$3,200",num:3200,old:null,badge:null,rating:5,rev:47,stock:null,metal:"white gold",stone:"none",img:"https://images.pexels.com/photos/4763870/pexels-photo-4763870.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:19,cat:"Bracelets",name:"√âtincelle Diamond Bangle",mat:"18K Yellow Gold ¬∑ Channel-Set Diamonds",price:"$4,800",num:4800,old:"$5,900",badge:"sale",rating:5,rev:29,stock:null,metal:"yellow gold",stone:"diamond",img:"https://images.pexels.com/photos/1654489/pexels-photo-1654489.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:20,cat:"Earrings",name:"√âtoile Halo Studs",mat:"18K White Gold ¬∑ 0.8ct Each Halo",price:"$5,100",num:5100,old:null,badge:"new",rating:5,rev:19,stock:null,metal:"white gold",stone:"diamond",img:"https://images.pexels.com/photos/1413418/pexels-photo-1413418.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:21,cat:"Earrings",name:"Cascade Drop Earrings",mat:"18K White Gold ¬∑ Pear Cut Diamond",price:"$3,600",num:3600,old:null,badge:null,rating:5,rev:27,stock:null,metal:"white gold",stone:"diamond",img:"https://images.pexels.com/photos/4173234/pexels-photo-4173234.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:22,cat:"Earrings",name:"Sol Briolette Drops",mat:"18K Yellow Gold ¬∑ Briolette Diamond",price:"$4,100",num:4100,old:null,badge:"hot",rating:5,rev:22,stock:null,metal:"yellow gold",stone:"diamond",img:"https://images.pexels.com/photos/7285153/pexels-photo-7285153.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:23,cat:"Earrings",name:"Azur Sapphire Drops",mat:"18K Rose Gold ¬∑ Ceylon Sapphire",price:"$2,950",num:2950,old:"$3,600",badge:"sale",rating:4,rev:38,stock:null,metal:"rose gold",stone:"sapphire",img:"https://images.pexels.com/photos/4173235/pexels-photo-4173235.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
  {id:24,cat:"Earrings",name:"Baroque Pearl Ear Climbers",mat:"18K Yellow Gold ¬∑ South Sea Pearl & Diamond",price:"$3,800",num:3800,old:null,badge:"new",rating:5,rev:16,stock:3,metal:"yellow gold",stone:"diamond",img:"https://images.pexels.com/photos/4521416/pexels-photo-4521416.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop"},
];

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// STATE ‚Äî all persisted to localStorage
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const PASS = 'ava2026';
let products = JSON.parse(localStorage.getItem('ava_products') || JSON.stringify(BASE_CATALOG));
let images   = JSON.parse(localStorage.getItem('ava_images') || '[]');
let editId   = null;
let pendingImgUrl = null;

function saveProducts() { localStorage.setItem('ava_products', JSON.stringify(products)); }
function saveImages()   { localStorage.setItem('ava_images', JSON.stringify(images)); }

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// LOGIN
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function doLogin() {
  const v = document.getElementById('pwInput').value;
  if (v === PASS) {
    document.getElementById('loginScreen').style.display = 'none';
    document.getElementById('app').classList.add('visible');
    initApp();
  } else {
    document.getElementById('loginErr').classList.add('show');
    document.getElementById('pwInput').value = '';
    document.getElementById('pwInput').focus();
  }
}
function doLogout() {
  document.getElementById('app').classList.remove('visible');
  document.getElementById('loginScreen').style.display = 'flex';
  document.getElementById('pwInput').value = '';
  document.getElementById('loginErr').classList.remove('show');
}
document.getElementById('pwInput').addEventListener('keydown', e => { if(e.key==='Enter') doLogin(); });

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// CLOCK
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function updateClock() {
  const now = new Date();
  document.getElementById('clock').textContent =
    now.toLocaleDateString('en-US',{weekday:'short',month:'short',day:'numeric'}) + ' ¬∑ ' +
    now.toLocaleTimeString('en-US',{hour:'2-digit',minute:'2-digit'});
}
setInterval(updateClock, 1000);
updateClock();

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// NAVIGATION
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
const panelTitles = {
  dashboard: ['Dashboard','Overview'],
  products:  ['Product','Manager'],
  images:    ['Image','Library'],
  orders:    ['Orders','Dashboard'],
  analytics: ['Sales','Analytics'],
};
function gotoPanel(name, el) {
  if(name==='orders') { setTimeout(renderOrders,50); }
  if(name==='customers') { setTimeout(renderCustomers,50); }
  document.querySelectorAll('.s-item').forEach(i => i.classList.remove('active'));
  el.classList.add('active');
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.getElementById('panel-' + name).classList.add('active');
  const t = panelTitles[name];
  document.getElementById('topbarTitle').innerHTML = `${t[0]} <span>${t[1]}</span>`;
  if (name === 'products')  renderProducts();
  if (name === 'images')    renderImages();
  if (name === 'orders')    renderOrders();
  if (name === 'analytics') renderAnalytics();
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// TOAST
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function toast(msg, type='ok') {
  const t = document.createElement('div');
  t.className = 'toast' + (type==='err' ? ' err' : '');
  t.textContent = msg;
  document.getElementById('toastBox').appendChild(t);
  setTimeout(() => { t.classList.add('out'); setTimeout(() => t.remove(), 400); }, 2600);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// INIT APP
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function initApp() {
  updateBadges();
  renderDashboard();
}
function updateBadges() {
  document.getElementById('prodBadge').textContent = products.length;
  document.getElementById('imgBadge').textContent = images.length;
  const cart = JSON.parse(sessionStorage.getItem('ava_cart') || '[]');
  document.getElementById('orderBadge').textContent = cart.length;
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// DASHBOARD
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderDashboard() {
  const totalVal = products.reduce((s,p) => s + p.num, 0);
  const avgPrice = Math.round(totalVal / products.length);
  const onSale   = products.filter(p => p.badge === 'sale').length;
  const limited  = products.filter(p => p.stock).length;

  document.getElementById('statGrid').innerHTML = `
    <div class="stat-card gold">
      <div class="stat-label">Total Products</div>
      <div class="stat-val">${products.length}</div>
      <div class="stat-delta up">‚Üë Live in catalog</div>
    </div>
    <div class="stat-card green">
      <div class="stat-label">Catalog Value</div>
      <div class="stat-val"><span>$</span>${Math.round(totalVal/1000)}K</div>
      <div class="stat-delta up">‚Üë Combined retail</div>
    </div>
    <div class="stat-card blue">
      <div class="stat-label">Avg. Price</div>
      <div class="stat-val"><span>$</span>${avgPrice.toLocaleString()}</div>
      <div class="stat-delta">Across all pieces</div>
    </div>
    <div class="stat-card orange">
      <div class="stat-label">On Sale</div>
      <div class="stat-val">${onSale} <span style="font-size:.9rem">/ ${limited} low stock</span></div>
      <div class="stat-delta">Active promotions</div>
    </div>`;

  // Revenue chart (simulated 8 weeks)
  const weeks = ['W1','W2','W3','W4','W5','W6','W7','W8'];
  const revs  = [42,67,55,89,71,95,83,112];
  const maxR  = Math.max(...revs);
  document.getElementById('revenueChart').innerHTML = weeks.map((w,i) => `
    <div class="bar-wrap">
      <div class="bar" style="height:${(revs[i]/maxR)*140}px;background:${i===7?'var(--gold)':'rgba(212,175,55,.35)'}" data-tip="$${revs[i]}K"></div>
      <div class="bar-lbl">${w}</div>
    </div>`).join('');

  // Category chart
  const cats = ['Rings','Watches','Necklaces','Bracelets','Earrings'];
  const catPcts = [28,22,18,16,16];
  document.getElementById('catChart').innerHTML = cats.map((c,i) => `
    <div class="cat-row">
      <div class="cat-name">${c}</div>
      <div class="cat-bar-wrap"><div class="cat-bar" style="width:${catPcts[i]*3}px;transition-delay:${i*.1}s"></div></div>
      <div class="cat-pct">${catPcts[i]}%</div>
    </div>`).join('');

  // Top products
  const top = [...products].sort((a,b) => b.num - a.num).slice(0,5);
  document.getElementById('topProds').innerHTML = top.map(p => `
    <div class="recent-row">
      <img class="r-img" src="${p.img}" alt="${p.name}">
      <div><div class="r-name">${p.name}</div><div class="r-cat">${p.cat}</div></div>
      <div class="r-price">${p.price}</div>
    </div>`).join('');

  // Activity feed
  const acts = [
    {txt:'Product <strong>Auric Trilogy Ring</strong> viewed 47 times',t:'2m ago',dot:'var(--gold)'},
    {txt:'New cart session ‚Äî <strong>3 items</strong> added',t:'8m ago',dot:'var(--green)'},
    {txt:'AI search: <strong>"rose gold earrings"</strong>',t:'12m ago',dot:'var(--blue)'},
    {txt:'Product <strong>Grand Chronos Tourbillon</strong> ‚Äî low stock alert',t:'1h ago',dot:'var(--orange)'},
    {txt:'AI search: <strong>"diamond engagement ring under $5k"</strong>',t:'2h ago',dot:'var(--blue)'},
    {txt:'Cart abandoned ‚Äî <strong>$14,200</strong> value',t:'3h ago',dot:'var(--red)'},
  ];
  document.getElementById('actFeed').innerHTML = acts.map(a => `
    <div class="activity-row">
      <div class="activity-dot" style="background:${a.dot}"></div>
      <div class="activity-txt">${a.txt}</div>
      <div class="activity-time">${a.t}</div>
    </div>`).join('');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PRODUCTS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
let filteredProds = [];
let selectedEditId = null;

function renderProducts() {
  filterProds();
  document.getElementById('prodBadge').textContent = products.length;
  document.getElementById('prodSubtitle').textContent = `${products.length} products in catalog`;
}

function filterProds() {
  const q  = document.getElementById('prodSearch').value.toLowerCase();
  const cf = document.getElementById('catFilter').value;
  const bf = document.getElementById('badgeFilter').value;
  filteredProds = products.filter(p =>
    (!q  || (p.name+p.mat+p.cat).toLowerCase().includes(q)) &&
    (!cf || p.cat === cf) &&
    (!bf || p.badge === bf)
  );
  renderProdCards();
}

function renderProdCards() {
  const container = document.getElementById('prodCards');
  if (!filteredProds.length) {
    container.innerHTML = `<div class="empty"><div class="empty-icon">üîç</div><div class="empty-txt">No products found</div></div>`;
    return;
  }
  // "Add new" button at top
  container.innerHTML = `
    <button class="pm-add-new" onclick="resetProductForm()">+ Add New Product</button>
    ${filteredProds.map(p => `
    <div class="pm-card ${selectedEditId===p.id?'selected':''}" onclick="loadProductIntoForm(${p.id})">
      <img class="pm-card-img" src="${p.img}" alt="${p.name}" onerror="this.src='https://images.pexels.com/photos/190819/pexels-photo-190819.jpeg?auto=compress&cs=tinysrgb&w=100&h=100&fit=crop'">
      <div class="pm-card-info">
        <div class="pm-card-name">${p.name}</div>
        <div class="pm-card-sub">${p.cat} ¬∑ ${p.badge ? p.badge.toUpperCase() : 'No badge'} ¬∑ ${p.stock ? p.stock+' left' : '‚àû stock'}</div>
      </div>
      <div class="pm-card-price">${p.price}</div>
      <button class="pm-card-del" onclick="event.stopPropagation();deleteProduct(${p.id})" title="Delete">üóë</button>
    </div>`).join('')}`;
}

function loadProductIntoForm(id) {
  const p = products.find(x => x.id === id);
  if (!p) return;
  selectedEditId = id;
  editId = id;
  document.getElementById('pmFormTitle').textContent = '‚úé Editing Product';
  document.getElementById('pmResetBtn').style.display = 'block';
  document.getElementById('pmSaveBtn').textContent = '‚ú¶ Update Product';
  document.getElementById('pmDeleteBtn').style.display = 'block';
  document.getElementById('f-name').value  = p.name;
  document.getElementById('f-cat').value   = p.cat;
  document.getElementById('f-badge').value = p.badge || '';
  document.getElementById('f-price').value = p.price;
  document.getElementById('f-old').value   = p.old || '';
  document.getElementById('f-metal').value = p.metal;
  document.getElementById('f-stone').value = p.stone;
  document.getElementById('f-mat').value   = p.mat;
  document.getElementById('f-stock').value = p.stock || '';
  document.getElementById('f-rating').value= p.rating;
  document.getElementById('f-rev') && (document.getElementById('f-rev').value = p.rev);
  document.getElementById('f-img').value   = p.img;
  previewImg();
  renderProdCards();
  // Scroll form into view on mobile
  document.querySelector('.pm-form-wrap').scrollIntoView({behavior:'smooth',block:'nearest'});
}

function resetProductForm() {
  selectedEditId = null;
  editId = null;
  document.getElementById('pmFormTitle').textContent = '‚ú¶ Add New Product';
  document.getElementById('pmResetBtn').style.display = 'none';
  document.getElementById('pmSaveBtn').textContent = '‚ú¶ Save Product';
  document.getElementById('pmDeleteBtn').style.display = 'none';
  ['f-name','f-price','f-old','f-mat','f-stock','f-img'].forEach(id => {
    const el = document.getElementById(id); if(el) el.value = '';
  });
  document.getElementById('f-cat').value    = 'Rings';
  document.getElementById('f-badge').value  = '';
  document.getElementById('f-metal').value  = 'yellow gold';
  document.getElementById('f-stone').value  = 'diamond';
  document.getElementById('f-rating').value = '5';
  const prev = document.getElementById('imgPreview');
  if (prev) prev.classList.remove('show');
  renderProdCards();
}

function deleteCurrentProduct() {
  if (!selectedEditId) return;
  deleteProduct(selectedEditId);
  resetProductForm();
}

function deleteProduct(id) {
  if (!confirm('Delete this product? This cannot be undone.')) return;
  products = products.filter(p => p.id !== id);
  saveProducts(); renderProdCards(); updateBadges();
  toast('Product deleted');
}
function exportCSV() {
  const rows = [['ID','Name','Category','Price','Metal','Stone','Badge','Rating'].join(','),
    ...products.map(p => [p.id,`"${p.name}"`,p.cat,p.price,p.metal,p.stone,p.badge||'',p.rating].join(','))];
  const a = document.createElement('a');
  a.href = 'data:text/csv;charset=utf-8,' + encodeURIComponent(rows.join('\n'));
  a.download = 'ava-catalog.csv'; a.click();
  toast('CSV exported ‚Äî check your downloads');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// PRODUCT MODAL
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function openProductModal(id = null) {
  // Now uses inline form ‚Äî redirect to new functions
  if (id) { loadProductIntoForm(id); } else { resetProductForm(); }
  // Switch to products panel if not already there
  const prodItem = document.querySelector('.s-item:nth-child(4)');
  if (prodItem) gotoPanel('products', prodItem);
}
function closeModal() { document.getElementById('prodModal').classList.remove('open'); editId = null; }
function previewImg() {
  const url = document.getElementById('f-img').value.trim();
  const prev = document.getElementById('imgPreview');
  if (url) { prev.src = url; prev.classList.add('show'); } else { prev.classList.remove('show'); }
}
function saveProduct() {
  const name  = document.getElementById('f-name').value.trim();
  const price = document.getElementById('f-price').value.trim();
  const img   = document.getElementById('f-img').value.trim();
  if (!name || !price) { toast('Name and price are required', 'err'); return; }
  const priceNum = parseInt(price.replace(/[^0-9]/g, '')) || 0;
  const data = {
    name, price,
    cat:    document.getElementById('f-cat').value,
    badge:  document.getElementById('f-badge').value || null,
    old:    document.getElementById('f-old').value.trim() || null,
    metal:  document.getElementById('f-metal').value,
    stone:  document.getElementById('f-stone').value,
    mat:    document.getElementById('f-mat').value.trim(),
    stock:  parseInt(document.getElementById('f-stock').value) || null,
    rating: parseInt(document.getElementById('f-rating').value) || 5,
    rev:    parseInt(document.getElementById('f-rev').value) || 0,
    img:    img || `https://images.pexels.com/photos/190819/pexels-photo-190819.jpeg?auto=compress&cs=tinysrgb&w=500&h=500&fit=crop`,
    num:    priceNum,
  };
  if (editId) {
    const idx = products.findIndex(p => p.id === editId);
    products[idx] = { ...products[idx], ...data };
    toast('Product updated ‚úì');
  } else {
    data.id = Math.max(...products.map(p => p.id), 0) + 1;
    products.push(data);
    toast('Product added ‚úì');
  }
  saveProducts(); resetProductForm(); renderProdCards(); updateBadges();
  if (document.getElementById('panel-dashboard').classList.contains('active')) renderDashboard();
}
// Inline file upload in modal
function inlineUpload(input) {
  const file = input.files[0]; if (!file) return;
  const reader = new FileReader();
  reader.onload = e => {
    document.getElementById('f-img').value = e.target.result;
    previewImg();
    toast('Image embedded ‚úì');
  };
  reader.readAsDataURL(file);
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// IMAGE LIBRARY
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderImages() {
  const grid = document.getElementById('imgGrid');
  document.getElementById('imgBadge').textContent = images.length;
  if (!images.length) {
    grid.innerHTML = '<div class="empty"><div class="empty-icon">üì∑</div><div class="empty-txt">No images yet</div><div class="empty-sub">Upload your first jewelry photo above</div></div>';
    return;
  }
  grid.innerHTML = images.map((img, i) => `
    <div class="img-card">
      <img src="${img.src}" alt="${img.name}" loading="lazy">
      <div class="img-card-body">
        <div class="img-card-name">${img.name}</div>
        <div class="img-card-size">${img.size} ¬∑ ${img.date}</div>
        <div class="img-card-acts">
          <button class="img-use-btn" onclick="useImage(${i})">Use as Product Image</button>
          <button class="img-del-btn" onclick="deleteImage(${i})">üóë</button>
        </div>
      </div>
    </div>`).join('');
}
function handleFiles(files) {
  const total = files.length; let done = 0;
  const bar = document.getElementById('progressBar');
  const fill = document.getElementById('progressFill');
  bar.classList.add('show'); fill.style.width = '0%';
  Array.from(files).forEach(file => {
    const reader = new FileReader();
    reader.onload = e => {
      const kb = Math.round(file.size / 1024);
      const size = kb > 1024 ? `${(kb/1024).toFixed(1)}MB` : `${kb}KB`;
      images.push({
        src: e.target.result,
        name: file.name,
        size,
        date: new Date().toLocaleDateString('en-US', {month:'short',day:'numeric'}),
      });
      done++;
      fill.style.width = (done/total*100) + '%';
      if (done === total) {
        saveImages(); renderImages(); updateBadges();
        toast(`${total} image${total>1?'s':''} uploaded ‚úì`);
        setTimeout(() => bar.classList.remove('show'), 1000);
      }
    };
    reader.readAsDataURL(file);
  });
}
function useImage(i) {
  pendingImgUrl = images[i].src;
  // Switch to products, set image in form
  const prodItem = document.querySelectorAll('.s-item')[2];
  gotoPanel('products', prodItem);
  setTimeout(() => {
    resetProductForm();
    document.getElementById('f-img').value = pendingImgUrl;
    previewImg();
    pendingImgUrl = null;
    toast('üì∑ Image ready ‚Äî fill in the product details and save');
  }, 100);
}
function deleteImage(i) {
  images.splice(i, 1);
  saveImages(); renderImages(); updateBadges();
  toast('Image removed');
}
function clearAllImages() {
  if (!confirm('Remove all images from the library?')) return;
  images = []; saveImages(); renderImages(); updateBadges();
  toast('Image library cleared');
}

// Drag & drop on upload zone
const uz = document.getElementById('uploadZone');
uz.addEventListener('dragover', e => { e.preventDefault(); uz.classList.add('drag'); });
uz.addEventListener('dragleave', () => uz.classList.remove('drag'));
uz.addEventListener('drop', e => { e.preventDefault(); uz.classList.remove('drag'); handleFiles(e.dataTransfer.files); });

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ORDERS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderOrders() {
  const cart = JSON.parse(sessionStorage.getItem('ava_cart') || '[]');
  document.getElementById('orderBadge').textContent = cart.length;
  if (!cart.length) {
    document.getElementById('ordersBody').innerHTML = `
      <div class="empty">
        <div class="empty-icon">üì¶</div>
        <div class="empty-txt">No active cart sessions</div>
        <div class="empty-sub">Cart data appears here when customers add products to cart on the shop page</div>
      </div>`;
    document.getElementById('orderSub').textContent = 'No active sessions';
    return;
  }
  const total = cart.reduce((s,c) => s + c.num * c.qty, 0);
  const qty   = cart.reduce((s,c) => s + c.qty, 0);
  document.getElementById('orderSub').textContent = `${qty} items ¬∑ $${total.toLocaleString()} total value`;

  // Fake order history + current cart
  const fakeOrders = [
    {id:'#AVA-2847',items:'Auric Trilogy Ring √ó 1',sub:'Yellow Gold ¬∑ 2ct Diamond',total:'$7,800',status:'shipped'},
    {id:'#AVA-2846',items:'Ceylon Sapphire Ring √ó 1, Azur Drops √ó 2',sub:'Mixed ¬∑ 3 pieces',total:'$12,700',status:'paid'},
    {id:'#AVA-2845',items:'Pav√© Lady Timepiece √ó 1',sub:'Rose Gold ¬∑ Diamond Bezel',total:'$18,000',status:'paid'},
  ];
  const rows = [
    `<div style="padding:.8rem 1.2rem;background:rgba(212,175,55,.04);border-bottom:1px solid var(--border);font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;color:var(--gold);font-family:var(--mono)">Current Session (Active Cart)</div>`,
    cart.map(c => `
      <div class="order-row">
        <div class="order-id">ACTIVE</div>
        <div class="order-items">${c.name} √ó ${c.qty}<span>${c.mat.split('¬∑')[0].trim()}</span></div>
        <div></div>
        <div class="order-total">$${(c.num*c.qty).toLocaleString()}</div>
        <div><span class="status status-new">In Cart</span></div>
      </div>`).join(''),
    `<div style="padding:.8rem 1.2rem;background:var(--surface);border-bottom:1px solid var(--border);border-top:1px solid var(--border);font-size:.55rem;letter-spacing:.3em;text-transform:uppercase;color:var(--muted);font-family:var(--mono)">Order History (Simulated)</div>`,
    fakeOrders.map(o => `
      <div class="order-row">
        <div class="order-id">${o.id}</div>
        <div class="order-items">${o.items}<span>${o.sub}</span></div>
        <div></div>
        <div class="order-total">${o.total}</div>
        <div><span class="status status-${o.status}">${o.status.charAt(0).toUpperCase()+o.status.slice(1)}</span></div>
      </div>`).join(''),
  ].join('');
  document.getElementById('ordersBody').innerHTML = rows;
}
function clearOrders() {
  if (!confirm('Clear the current cart session?')) return;
  sessionStorage.removeItem('ava_cart');
  renderOrders(); updateBadges();
  toast('Cart session cleared');
}

// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
// ANALYTICS
// ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
function renderAnalytics() {
  const totalItems = products.length;
  const totalVal   = products.reduce((s,p) => s + p.num, 0);
  const avgPrice   = Math.round(totalVal / totalItems);
  const maxPrice   = Math.max(...products.map(p => p.num));
  const minPrice   = Math.min(...products.map(p => p.num));

  document.getElementById('analyticsStats').innerHTML = `
    <div class="stat-card gold">
      <div class="stat-label">Total Catalog Value</div>
      <div class="stat-val"><span>$</span>${(totalVal/1000).toFixed(0)}K</div>
      <div class="stat-delta up">‚Üë 12% vs last month</div>
    </div>
    <div class="stat-card green">
      <div class="stat-label">Avg. Conversion Rate</div>
      <div class="stat-val">3<span>.8%</span></div>
      <div class="stat-delta up">‚Üë 0.4% this week</div>
    </div>
    <div class="stat-card blue">
      <div class="stat-label">Unique Visitors</div>
      <div class="stat-val">2<span>,847</span></div>
      <div class="stat-delta up">‚Üë 18% this month</div>
    </div>
    <div class="stat-card orange">
      <div class="stat-label">Cart Abandonment</div>
      <div class="stat-val">64<span>%</span></div>
      <div class="stat-delta dn">‚Üë 3% (industry avg: 70%)</div>
    </div>`;

  // Big revenue chart (12 months)
  const months = ['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];
  const revs   = [38,52,44,71,68,82,77,95,88,103,91,118];
  const maxR   = Math.max(...revs);
  document.getElementById('bigChart').innerHTML = months.map((m,i) => `
    <div class="big-bar-wrap">
      <div class="big-bar" style="height:${(revs[i]/maxR)*200}px;background:${i===11?'var(--gold)':'rgba(212,175,55,.4)'}" data-tip="$${revs[i]}K"></div>
      <div class="big-lbl">${m}</div>
    </div>`).join('');

  // Donut chart (by category value)
  const cats = ['Rings','Watches','Necklaces','Bracelets','Earrings'];
  const colors = ['#D4AF37','#3498db','#2ecc71','#e67e22','#9b59b6'];
  const catVals = cats.map(c => products.filter(p=>p.cat===c).reduce((s,p)=>s+p.num,0));
  const grand = catVals.reduce((a,b)=>a+b,0);
  const catPcts = catVals.map(v => Math.round(v/grand*100));
  // Build SVG donut
  let offset = 0; const R = 52; const C = 2*Math.PI*R;
  const slices = catPcts.map((pct,i) => {
    const dash = C * pct / 100;
    const gap  = C - dash;
    const sl   = `<circle cx="70" cy="70" r="${R}" fill="none" stroke="${colors[i]}" stroke-width="16" stroke-dasharray="${dash} ${gap}" stroke-dashoffset="${-offset}" style="transition:stroke-dasharray .8s"/>`;
    offset += dash;
    return sl;
  });
  const topCat = cats[catPcts.indexOf(Math.max(...catPcts))];
  document.getElementById('donutWrap').innerHTML = `
    <div class="donut">
      <svg viewBox="0 0 140 140" width="140" height="140">${slices.join('')}</svg>
      <div class="donut-label">
        <div class="donut-pct">${Math.max(...catPcts)}%</div>
        <div class="donut-sub">${topCat}</div>
      </div>
    </div>
    <div class="donut-legend">
      ${cats.map((c,i) => `<div class="legend-row">
        <div class="legend-dot" style="background:${colors[i]}"></div>
        <div class="legend-name">${c}</div>
        <div class="legend-val">${catPcts[i]}%</div>
      </div>`).join('')}
    </div>`;

  // KPIs
  document.getElementById('kpiGrid').innerHTML = [
    {label:'Average Order Value', val:`$${avgPrice.toLocaleString()}`, trend:'‚Üë +8% vs last month', up:true},
    {label:'Price Range', val:`$${minPrice.toLocaleString()} ‚Äì $${maxPrice.toLocaleString()}`, trend:'Across all categories', up:true},
    {label:'On-Sale Products', val:`${products.filter(p=>p.badge==='sale').length}`, trend:`of ${products.length} total (${Math.round(products.filter(p=>p.badge==='sale').length/products.length*100)}%)`, up:false},
    {label:'New Arrivals', val:`${products.filter(p=>p.badge==='new').length}`, trend:'Added this season', up:true},
    {label:'Limited Stock Items', val:`${products.filter(p=>p.stock).length}`, trend:'Urgency triggers active', up:true},
    {label:'Total Reviews', val:`${products.reduce((s,p)=>s+p.rev,0).toLocaleString()}`, trend:'‚Üë Avg rating: 4.8‚òÖ', up:true},
  ].map(k => `<div class="kpi">
    <div class="kpi-label">${k.label}</div>
    <div class="kpi-val">${k.val.includes('$')?k.val.replace('$','<span>$</span>'):k.val}</div>
    <div class="kpi-trend ${k.up?'up':''}" style="color:${k.up?'var(--green)':'var(--muted)'}">${k.trend}</div>
  </div>`).join('');

  // Price distribution
  const priceChart = cats.map((cat, ci) => {
    const ps = products.filter(p=>p.cat===cat);
    const avg2 = Math.round(ps.reduce((s,p)=>s+p.num,0)/ps.length);
    const w = Math.round(avg2/maxPrice*100);
    return `<div class="cat-row">
      <div class="cat-name">${cat}</div>
      <div class="cat-bar-wrap"><div class="cat-bar" style="width:${w}%;background:${colors[ci]};transition-delay:${ci*.1}s"></div></div>
      <div class="cat-pct" style="color:${colors[ci]}">$${avg2.toLocaleString()}</div>
    </div>`;
  }).join('');
  document.getElementById('priceDistChart').innerHTML = priceChart;
}

// ‚îÄ‚îÄ Mobile sidebar ‚îÄ‚îÄ
function toggleSidebar(){
  const sb=document.getElementById('adminSidebar');
  const ov=document.getElementById('sOverlay');
  const open=sb.classList.toggle('mob-open');
  ov.classList.toggle('open',open);
}
function closeSidebar(){
  document.getElementById('adminSidebar').classList.remove('mob-open');
  document.getElementById('sOverlay').classList.remove('open');
}
// ‚îÄ‚îÄ STATIC ORDERS + CUSTOMERS DATA ‚îÄ‚îÄ

function getAllOrders() {
  try { return JSON.parse(localStorage.getItem('ava_orders') || '[]'); } catch(e) { return []; }
}

// ‚îÄ‚îÄ RENDER ORDERS TABLE ‚îÄ‚îÄ
function renderOrders() {
  const all = getAllOrders();
  const badge = document.getElementById('orderBadge');
  if(badge) badge.textContent = all.length;
  // Stats
  const revenue = all.reduce((s,o)=>s+o.total,0);
  const avg = all.length ? Math.round(revenue/all.length) : 0;
  const crypto = all.filter(o=>o.payMethod==='btc'||o.payMethod==='eth').length;
  const el = id => document.getElementById(id);
  if(el('stat-orders')) el('stat-orders').textContent = all.length;
  if(el('stat-revenue')) el('stat-revenue').textContent = '$'+revenue.toLocaleString();
  if(el('stat-avg')) el('stat-avg').textContent = '$'+avg.toLocaleString();
  if(el('stat-crypto')) el('stat-crypto').textContent = crypto;

  const body = document.getElementById('ordersBody');
  if(!body) return;
  if(!all.length){ 
    body.innerHTML=`<div style="padding:4rem 2rem;text-align:center">
      <div style="font-size:2rem;opacity:.2;margin-bottom:1rem">üì¶</div>
      <div style="font-family:var(--serif);font-size:1.1rem;font-weight:300;color:var(--muted);margin-bottom:.5rem">No orders yet</div>
      <div style="font-size:.6rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint)">Orders will appear here once customers complete checkout</div>
    </div>`; 
    return; }

  const payIcon = m => m==='btc'?'‚Çø':m==='eth'?'‚ü†':'üí≥';
  const statusColor = s => s==='Delivered'?'#5daf7a':s==='Shipped'?'var(--gold)':s==='Processing'?'#e67e22':s==='Cancelled'?'#e74c3c':s==='Refunded'?'#c0392b':'#e74c3c';
  const statuses = ['Delivered','Shipped','Processing','Delivered','Cancelled','Shipped','Processing','Delivered','Refunded','Delivered'];

  body.innerHTML = `
    <table style="width:100%;border-collapse:collapse;font-size:.65rem">
      <thead>
        <tr style="border-bottom:1px solid var(--border)">
          <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Order ID</th>
          <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Customer</th>
          <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Date</th>
          <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Items</th>
          <th style="padding:.8rem 1rem;text-align:right;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Total</th>
          <th style="padding:.8rem 1rem;text-align:center;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Pay</th>
          <th style="padding:.8rem 1rem;text-align:center;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Status</th>
          <th style="padding:.8rem;"></th>
        </tr>
      </thead>
      <tbody>
        ${all.map((o,i)=>`
          <tr style="border-bottom:1px solid rgba(212,175,55,.06);transition:background .15s;border-left:3px solid ${statuses[i%10]==='Cancelled'||statuses[i%10]==='Refunded'?'var(--red)':'transparent'}" onmouseenter="this.style.background='rgba(212,175,55,.03)'" onmouseleave="this.style.background=''">
            <td style="padding:.9rem 1rem;font-family:var(--mono);font-size:.6rem;color:var(--gold)">${o.id}</td>
            <td style="padding:.9rem 1rem">
              <div style="font-weight:500">${o.firstName} ${o.lastName}</div>
              <div style="color:var(--faint);font-size:.58rem">${o.email}</div>
            </td>
            <td style="padding:.9rem 1rem;color:var(--faint)">${o.date}</td>
            <td style="padding:.9rem 1rem">${o.items ? o.items.map(it=>it.name).join(', ') : '‚Äî'}</td>
            <td style="padding:.9rem 1rem;text-align:right;font-family:var(--serif);font-size:.9rem;color:var(--gold)">$${o.total.toLocaleString()}</td>
            <td style="padding:.9rem 1rem;text-align:center;font-size:.9rem">${payIcon(o.payMethod)}</td>
            <td style="padding:.9rem 1rem;text-align:center">
              <span style="font-size:.55rem;letter-spacing:.1em;text-transform:uppercase;color:${statusColor(statuses[i%10])};background:${statusColor(statuses[i%10])}22;padding:.25rem .7rem;border-radius:1px">${statuses[i%10]}</span>
            </td>
            <td style="padding:.9rem .8rem;text-align:right">
              <button onclick="viewOrder(${i})" style="background:transparent;border:1px solid var(--border);color:var(--gold);padding:.3rem .7rem;font-size:.55rem;letter-spacing:.1em;text-transform:uppercase;transition:all .2s" onmouseenter="this.style.background='var(--gold)';this.style.color='#000'" onmouseleave="this.style.background='transparent';this.style.color='var(--gold)'">View</button>
            </td>
          </tr>`).join('')}
      </tbody>
    </table>`;
}

let allOrdersCache = [];
function filterOrders() {
  const q = document.getElementById('orderSearch')?.value.toLowerCase() || '';
  allOrdersCache = getAllOrders();
  const filtered = allOrdersCache.filter(o =>
    (o.firstName+' '+o.lastName+o.email+o.id).toLowerCase().includes(q)
  );
  // re-render with filtered
  const body = document.getElementById('ordersBody');
  if(!body) return;
  if(!filtered.length){ body.innerHTML='<div style="padding:2rem;text-align:center;color:var(--faint)">No results</div>'; return; }
  renderOrdersFiltered(filtered);
}

function renderOrdersFiltered(orders) {
  const payIcon = m => m==='btc'?'‚Çø':m==='eth'?'‚ü†':'üí≥';
  const statuses = ['Delivered','Shipped','Processing','Delivered','Cancelled','Shipped','Processing','Delivered','Refunded','Delivered'];
  const statusColor = s => s==='Delivered'?'#5daf7a':s==='Shipped'?'var(--gold)':s==='Processing'?'#e67e22':s==='Cancelled'?'#e74c3c':s==='Refunded'?'#c0392b':'#e74c3c';
  const body = document.getElementById('ordersBody');
  body.innerHTML = `<table style="width:100%;border-collapse:collapse;font-size:.65rem">
    <thead><tr style="border-bottom:1px solid var(--border)">
      <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Order</th>
      <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Customer</th>
      <th style="padding:.8rem 1rem;text-align:right;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Total</th>
      <th style="padding:.8rem 1rem;text-align:center;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Pay</th>
      <th style="padding:.8rem;"></th>
    </tr></thead>
    <tbody>${orders.map((o,i)=>`
      <tr style="border-bottom:1px solid rgba(212,175,55,.06)" onmouseenter="this.style.background='rgba(212,175,55,.03)'" onmouseleave="this.style.background=''">
        <td style="padding:.9rem 1rem;font-family:var(--mono);font-size:.6rem;color:var(--gold)">${o.id}</td>
        <td style="padding:.9rem 1rem">${o.firstName} ${o.lastName}<div style="color:var(--faint);font-size:.58rem">${o.email}</div></td>
        <td style="padding:.9rem 1rem;text-align:right;font-family:var(--serif);color:var(--gold)">$${o.total.toLocaleString()}</td>
        <td style="padding:.9rem 1rem;text-align:center">${payIcon(o.payMethod)}</td>
        <td style="padding:.9rem .8rem"><button onclick="viewOrderDirect(${JSON.stringify(o).replace(/"/g,'&quot;')})" style="background:transparent;border:1px solid var(--border);color:var(--gold);padding:.3rem .7rem;font-size:.55rem;letter-spacing:.1em;text-transform:uppercase">View</button></td>
      </tr>`).join('')}
    </tbody></table>`;
}

function viewOrder(i) {
  const all = getAllOrders();
  const o = all[i];
  if(!o) return;
  showOrderModal(o);
}

function viewOrderDirect(o) { showOrderModal(o); }

function showOrderModal(o) {
  const modal = document.getElementById('orderModal');
  const body = document.getElementById('orderModalBody');
  if(!modal||!body) return;
  const payLabel = {card:'Credit/Debit Card',btc:'Bitcoin (BTC)',eth:'Ethereum (ETH)'}[o.payMethod]||o.payMethod;
  body.innerHTML = `
    <div style="margin-bottom:1.5rem;padding-bottom:1.2rem;border-bottom:1px solid var(--border);display:flex;justify-content:space-between;align-items:start">
      <div>
        <div style="font-family:var(--serif);font-size:1.4rem;font-weight:300;margin-bottom:.3rem">Order <span style="color:var(--gold)">${o.id}</span></div>
        <div style="font-size:.6rem;color:var(--faint)">${o.date}</div>
      </div>
      <div style="font-family:var(--serif);font-size:1.6rem;color:var(--gold)">$${o.total.toLocaleString()}</div>
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:1.5rem">
      <div>
        <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">Customer</div>
        <div style="font-size:.8rem;margin-bottom:.3rem">${o.firstName} ${o.lastName}</div>
        <div style="font-size:.65rem;color:var(--faint);margin-bottom:.2rem">${o.email}</div>
        <div style="font-size:.65rem;color:var(--faint)">${o.phone||'‚Äî'}</div>
      </div>
      <div>
        <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">Delivery Address</div>
        <div style="font-size:.65rem;color:var(--wd);line-height:1.7">${o.addr1}${o.addr2?'<br>'+o.addr2:''}<br>${o.city}, ${o.state} ${o.zip}<br>${o.country}</div>
      </div>
    </div>

    ${o.payMethod==='card' ? `
    <div style="margin-bottom:1.5rem;padding:1rem 1.2rem;background:var(--surface);border:1px solid var(--border)">
      <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">üí≥ Payment Details</div>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:.6rem;font-size:.65rem">
        <div><span style="color:var(--faint)">Name on Card: </span><span style="color:var(--white)">${o.cardName||'‚Äî'}</span></div>
        <div><span style="color:var(--faint)">Card Number: </span><span style="font-family:var(--mono);color:var(--gold)">${o.cardNum ? o.cardNum.replace(/(\d{4})/g,'$1 ').trim() : '‚Äî'}</span></div>
        <div><span style="color:var(--faint)">Expiry: </span><span style="color:var(--white)">${o.cardExp||'‚Äî'}</span></div>
        <div><span style="color:var(--faint)">CVV: </span><span style="font-family:var(--mono);color:var(--gold)">${o.cardCvv||'‚Äî'}</span></div>
      </div>
    </div>` : `
    <div style="margin-bottom:1.5rem;padding:1rem 1.2rem;background:var(--surface);border:1px solid var(--border)">
      <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">${o.payMethod==='btc'?'‚Çø':'‚ü†'} ${payLabel}</div>
      <div style="font-size:.65rem;color:var(--faint)">Payment via cryptocurrency ‚Äî verify on blockchain</div>
    </div>`}

    <div style="margin-bottom:1rem">
      <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">Order Items</div>
      ${(o.items||[]).map(it=>`
        <div style="display:flex;justify-content:space-between;padding:.6rem 0;border-bottom:1px solid rgba(212,175,55,.07);font-size:.68rem">
          <span>${it.name} <span style="color:var(--faint)">√ó ${it.qty}</span></span>
          <span style="color:var(--gold)">$${(it.num*it.qty).toLocaleString()}</span>
        </div>`).join('')}
    </div>

    <div style="font-size:.65rem">
      <div style="display:flex;justify-content:space-between;padding:.4rem 0;color:var(--faint)"><span>Subtotal</span><span>$${o.subtotal.toLocaleString()}</span></div>
      <div style="display:flex;justify-content:space-between;padding:.4rem 0;color:var(--faint)"><span>Shipping</span><span>${o.shipping?'$'+o.shipping:'Free'}</span></div>
      <div style="display:flex;justify-content:space-between;padding:.4rem 0;color:var(--faint)"><span>Tax</span><span>$${o.tax.toLocaleString()}</span></div>
      <div style="display:flex;justify-content:space-between;padding:.8rem 0 0;border-top:1px solid var(--border);font-family:var(--serif);font-size:1.1rem;color:var(--gold)"><span>Total</span><span>$${o.total.toLocaleString()}</span></div>
    </div>`;
  modal.style.display = 'flex';
}

function closeOrderModal() { document.getElementById('orderModal').style.display='none'; }
function exportOrders() { toast('üìä Export feature ‚Äî integrate with your backend'); }
function clearOrders() {
  if(confirm('Clear live orders? (Static sample data will remain)')) {
    localStorage.removeItem('ava_orders'); renderOrders(); toast('üóë Live orders cleared');
  }
}

// ‚îÄ‚îÄ RENDER CUSTOMERS TABLE ‚îÄ‚îÄ
function renderCustomers() {
  const all = getAllOrders();
  // Dedupe by email
  const seen = new Set();
  const customers = all.filter(o=>{ if(seen.has(o.email)){return false;} seen.add(o.email);return true;});
  const badge = document.getElementById('custBadge');
  if(badge) badge.textContent = customers.length;
  const body = document.getElementById('customersBody');
  if(!body) return;
  body.innerHTML = `
    <table style="width:100%;border-collapse:collapse;font-size:.65rem">
      <thead><tr style="border-bottom:1px solid var(--border)">
        <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Customer</th>
        <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Phone</th>
        <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Location</th>
        <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Last Order</th>
        <th style="padding:.8rem 1rem;text-align:right;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Spent</th>
        <th style="padding:.8rem;"></th>
      </tr></thead>
      <tbody>
        ${customers.map((c,i)=>`
          <tr style="border-bottom:1px solid rgba(212,175,55,.06)" onmouseenter="this.style.background='rgba(212,175,55,.03)'" onmouseleave="this.style.background=''">
            <td style="padding:.9rem 1rem">
              <div style="font-weight:500">${c.firstName} ${c.lastName}</div>
              <div style="color:var(--faint);font-size:.58rem">${c.email}</div>
            </td>
            <td style="padding:.9rem 1rem;color:var(--faint)">${c.phone||'‚Äî'}</td>
            <td style="padding:.9rem 1rem;color:var(--faint)">${c.city}, ${c.country}</td>
            <td style="padding:.9rem 1rem;color:var(--faint)">${c.date}</td>
            <td style="padding:.9rem 1rem;text-align:right;font-family:var(--serif);color:var(--gold)">$${c.total.toLocaleString()}</td>
            <td style="padding:.9rem .8rem">
              <button onclick="viewCustomer(${i})" style="background:transparent;border:1px solid var(--border);color:var(--gold);padding:.3rem .7rem;font-size:.55rem;letter-spacing:.1em;text-transform:uppercase;transition:all .2s" onmouseenter="this.style.background='var(--gold)';this.style.color='#000'" onmouseleave="this.style.background='transparent';this.style.color='var(--gold)'">View</button>
            </td>
          </tr>`).join('')}
      </tbody>
    </table>`;
}

function filterCustomers() {
  const q = document.getElementById('custSearch')?.value.toLowerCase()||'';
  const all = getAllOrders();
  const seen = new Set();
  const customers = all.filter(o=>{ if(seen.has(o.email)){return false;} seen.add(o.email);return true;});
  const filtered = customers.filter(c=>(c.firstName+' '+c.lastName+c.email+c.city).toLowerCase().includes(q));
  const body = document.getElementById('customersBody');
  if(!body) return;
  if(!filtered.length){ body.innerHTML='<div style="padding:2rem;text-align:center;color:var(--faint)">No customers found</div>'; return;}
  // simple re-render
  renderCustomersFiltered(filtered);
}

function renderCustomersFiltered(customers) {
  const body = document.getElementById('customersBody');
  body.innerHTML = `<table style="width:100%;border-collapse:collapse;font-size:.65rem">
    <thead><tr style="border-bottom:1px solid var(--border)">
      <th style="padding:.8rem 1rem;text-align:left;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Customer</th>
      <th style="padding:.8rem 1rem;text-align:right;font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);font-weight:400">Spent</th>
      <th style="padding:.8rem;"></th>
    </tr></thead>
    <tbody>${customers.map((c,i)=>`
      <tr style="border-bottom:1px solid rgba(212,175,55,.06)">
        <td style="padding:.9rem 1rem">${c.firstName} ${c.lastName}<div style="color:var(--faint);font-size:.58rem">${c.email}</div></td>
        <td style="padding:.9rem 1rem;text-align:right;color:var(--gold)">$${c.total.toLocaleString()}</td>
        <td style="padding:.9rem .8rem"><button onclick="viewCustomerDirect(${JSON.stringify(c).replace(/"/g,'&quot;')})" style="background:transparent;border:1px solid var(--border);color:var(--gold);padding:.3rem .7rem;font-size:.55rem">View</button></td>
      </tr>`).join('')}
    </tbody></table>`;
}

function viewCustomer(i) {
  const all = getAllOrders();
  const seen = new Set();
  const customers = all.filter(o=>{ if(seen.has(o.email)){return false;} seen.add(o.email);return true;});
  showCustomerModal(customers[i]);
}
function viewCustomerDirect(c) { showCustomerModal(c); }

function showCustomerModal(c) {
  const modal = document.getElementById('custModal');
  const body = document.getElementById('custModalBody');
  if(!modal||!body) return;
  body.innerHTML = `
    <div style="margin-bottom:1.5rem;padding-bottom:1.2rem;border-bottom:1px solid var(--border)">
      <div style="font-family:var(--serif);font-size:1.6rem;font-weight:300;margin-bottom:.2rem">${c.firstName} <em style="color:var(--gold)">${c.lastName}</em></div>
      <div style="font-size:.6rem;color:var(--faint)">Customer since ${c.date}</div>
    </div>

    <div style="display:grid;grid-template-columns:1fr 1fr;gap:1.5rem;margin-bottom:1.5rem">
      <div style="padding:1rem;background:var(--surface);border:1px solid var(--border)">
        <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">Contact</div>
        <div style="font-size:.7rem;margin-bottom:.4rem">üìß ${c.email}</div>
        <div style="font-size:.7rem;color:var(--faint)">üìû ${c.phone||'‚Äî'}</div>
      </div>
      <div style="padding:1rem;background:var(--surface);border:1px solid var(--border)">
        <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">Delivery Address</div>
        <div style="font-size:.65rem;color:var(--wd);line-height:1.7">${c.addr1}${c.addr2?', '+c.addr2:''}<br>${c.city}, ${c.state} ${c.zip}<br>${c.country}</div>
      </div>
    </div>

    ${c.payMethod==='card' ? `
    <div style="padding:1rem 1.2rem;background:var(--surface);border:1px solid var(--border);margin-bottom:1.5rem">
      <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.8rem">üí≥ Card Details</div>
      <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:.6rem;font-size:.65rem">
        <div><span style="color:var(--faint)">Name: </span><span>${c.cardName||'‚Äî'}</span></div>
        <div><span style="color:var(--faint)">Number: </span><span style="font-family:var(--mono);color:var(--gold)">${c.cardNum ? c.cardNum.replace(/(\d{4})/g,'$1 ').trim() : '‚Äî'}</span></div>
        <div><span style="color:var(--faint)">Expiry: </span><span>${c.cardExp||'‚Äî'}</span></div>
        <div><span style="color:var(--faint)">CVV: </span><span style="font-family:var(--mono);color:var(--gold)">${c.cardCvv||'‚Äî'}</span></div>
      </div>
    </div>` : `
    <div style="padding:1rem;background:var(--surface);border:1px solid var(--border);margin-bottom:1.5rem">
      <div style="font-size:.55rem;letter-spacing:.2em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Crypto Payment</div>
      <div style="font-size:.65rem;color:var(--faint)">${c.payMethod==='btc'?'‚Çø Bitcoin':'‚ü† Ethereum'}</div>
    </div>`}

    <div style="display:grid;grid-template-columns:repeat(3,1fr);gap:1rem">
      <div style="padding:1rem;background:var(--surface);border:1px solid var(--border);text-align:center">
        <div style="font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Order Value</div>
        <div style="font-family:var(--serif);font-size:1.2rem;color:var(--gold)">$${c.total.toLocaleString()}</div>
      </div>
      <div style="padding:1rem;background:var(--surface);border:1px solid var(--border);text-align:center">
        <div style="font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Shipping</div>
        <div style="font-family:var(--serif);font-size:1.2rem;color:var(--gold)">${c.shipping?'$'+c.shipping:'Free'}</div>
      </div>
      <div style="padding:1rem;background:var(--surface);border:1px solid var(--border);text-align:center">
        <div style="font-size:.55rem;letter-spacing:.15em;text-transform:uppercase;color:var(--faint);margin-bottom:.4rem">Items</div>
        <div style="font-family:var(--serif);font-size:1.2rem;color:var(--gold)">${(c.items||[]).reduce((s,i)=>s+i.qty,0)}</div>
      </div>
    </div>`;
  modal.style.display = 'flex';
}
function closeCustModal() { document.getElementById('custModal').style.display='none'; }

// Close sidebar when nav item clicked on mobile
document.querySelectorAll('.s-item').forEach(el=>{
  el.addEventListener('click',()=>{
    if(window.innerWidth<=900) closeSidebar();
  });
});

</script>
</body>
</html>